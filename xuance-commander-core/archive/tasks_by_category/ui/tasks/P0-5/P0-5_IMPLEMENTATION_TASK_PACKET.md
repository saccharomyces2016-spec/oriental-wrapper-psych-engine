# P0-5 工程實作任務包：UMIP 實作（Implementation）

**狀態**：ACTIVE | EDITABLE | REFERENCE（非硬性、可隨時修正）  
**建立日期**：2026-01-10  
**版本**：v1.0  
**基於結案報告**：`P0-5/P0-5_UMIP_CLOSURE_REPORT.md` v1.0（開發與驗收的唯一依據）

---

## ⚠️ 重要聲明：所有內容保留修改空間

**本任務包中的所有設計、規格、決策均為暫時性版本，不得凍結。**

- 所有設計決策均可在後續討論中調整
- 所有技術實現方式均可變更
- 所有介面元素、流程、視覺風格均可修改
- 任何「最終版本」「確定方案」的說法均指「當前可執行的方案」，非永久凍結

**目標**：建立一個**可運作、可測試、可持續調整**的工程實作，滿足 6 項 MVP Gate 驗收標準。

---

## 📋 文件放置規範（必引用）

**權威規範**：請參考 `docs/governance/CURSOR_FILE_PLACEMENT_RULE.md`

**本任務包位置**：`xuance-commander-core/P0-5/P0-5_IMPLEMENTATION_TASK_PACKET.md`

**相關文件放置規則**：
- 階段文件 → `P0-5/`
- 工程實作代碼 → `prototype/` 或新建 `ui/` 目錄（待決定）
- 測試文件 → `tests/ui/` 或 `tests/umip/`（待決定）
- Schema 文件 → `schemas/umip_schema_v1.json`（新建立）
- 顧問任務包 → `docs/task_packets/advisor/task_packages/TASK_PACKAGE_P0-5_<Task>.md`
- 顧問輸出 → `docs/gem/runs/RUN_P0-5_<Task>_<Role>_<Date>.md`

**任務包集中管理**：見 `docs/task_packets/README.md` 和 `docs/task_packets/INDEX.md`

---

## 一、專案／任務背景摘要

### 1.1 這是什麼專案

**專案定位**：
- 打造一個以心理學、行為科學、認知結構、社會學、人類學等現代學術研究為底層引擎
- 結合 GPT 與 Gemini 等 AI 工具進行資訊收集與大數據庫建構
- 以東方命理、玄學、象數與隱喻作為人類可理解介面
- 能夠適用於全世界、全文化、全人類、全年齡、全性別、全困擾、全問題場景的解析、引導與連鎖互動系統

**核心價值**：
- **真的能賺錢**：商業可行性（序號買斷、信用卡、PayPal、Stripe）
- **真的可以上國際**：世界級水準，CN/EN 雙語原生語感
- **真的可以幫到人**：使用者真實感受到「這套玄學非常準，而且真的有幫助」

**使用者體驗終極目標**：
- 使用者只會、也只需要感知到：這是一個玄學網站、這是一套命理／神秘系統、這個系統非常準、這個系統對自己很有幫助
- 使用者不需要、也不應該被告知：任何心理學名詞、任何現代科學背景、任何「其實這不是玄學」的說明

### 1.2 為什麼現在要做這件事

**當前階段背景**：
- ✅ **P0-5 結案報告已定案**（`P0-5/P0-5_UMIP_CLOSURE_REPORT.md` v1.0）
  - UMIP（通用玄學介面協議）規格已完整
  - 6 項 MVP Gate 驗收標準已明確
  - 所有技術規格已確定，可直接開始工程實作
- ✅ **已有完整的數據結構**：
  - `compiled_facet.json` Schema 已定義（`schemas/compiled_facet.schema.json`）
  - 已有實例數據：`domain/compiled/stress_recovery.compiled.v1.0.json`
  - 已有評分引擎：`engine/score_facet.py`（可參考其數據處理邏輯）
- ✅ **已有基礎原型**：
  - `prototype/index.html`、`prototype/app.js`、`prototype/styles.css`
  - 提供基礎的 UI 結構和數據讀取邏輯（可作為起點）
- ✅ **已有完整的設計規格**：
  - `P0-5/P0-5_UI_ARCHITECTURE.md`：UI 架構設計
  - `P0-5/P0-5_UI_INTEGRATION_SPEC.md`：UI 串接規格
- ✅ **已有分流系統設計**：
  - `P0-4.5/P0-4.5_FUNNEL_SYSTEM_DESIGN.md`：4 階段全像漏斗系統設計
- ✅ **已有敘事規格與安全規範**：
  - `P0-3/R1_METRICS_V1_EXECUTABLE_SPEC.md`：敘事銳利度指標
  - `P0-3/R2_METAPHOR_BOUNDARY_BANLIST_HIGHRISK_TEMPLATES.md`：禁用詞表與高風險模板

**現在需要**：
- 根據已定案的 UMIP 結案報告實作 UI
- 滿足 6 項 MVP Gate 驗收標準
- 實現從 `compiled_facet.json` 到使用者體驗的完整流程

### 1.3 這次任務在整體中扮演什麼位置

**在整體架構中的角色**：
- **Phase 0：MVP（單一構面）**的最後一個階段的**工程實作階段**
- 連接「已定案的 UMIP 規格」與「可運行的 UI 實作」的關鍵橋樑
- 驗證「從結案報告到實際體驗」的完整流程

**與其他任務的關聯**：
- **依賴**：
  - ✅ P0-5 結案報告已定案（UMIP v1.0）
  - ✅ P0-1 至 P0-4.5 的所有成果（Facet 設計、敘事系統、分流系統）
  - ✅ 已有的 `compiled_facet.json` 數據結構和實例
- **提供**：
  - 為 P1-1（使用者驗證計劃）提供可測試的 UI
  - 為 P5-1（生產環境部署）提供可部署的代碼
- **驗證**：
  - 驗證 UMIP 協議的可行性
  - 驗證 6 項 MVP Gate 驗收標準的達成度

---

## 二、與本次任務相關的「過往任務回顧」

### 2.1 專案歷史摘要（Project History Summary）

**目的**：讓任務執行者理解整體脈絡，避免重複走老路。

#### 2.1.1 最近完成的任務（最近 5 個）

**任務摘要**（按照完成順序）：

1. **P0-1：選定第一個構面（Facet）**
   - **狀態**：✅ COMPLETED（2026-01-06）
   - **關鍵成果**：選定 Facet ID `income_expansion_pressure`（歲時農耕・倉廩觀）
   - **關鍵決策**：採用「歲時農耕・倉廩觀」作為第一個構面的主題
   - **相關文件**：`roadmap/ROADMAP.md`（P0-1 決策記錄）

2. **P0-2：建立該 facet 的 questions/scoring/reco/narr/risk**
   - **狀態**：✅ COMPLETED（2026-01-07）
   - **關鍵成果**：完成 questions、scoring、recommendations、narratives、riskchains 數據結構
   - **關鍵決策**：
     - 採納 R1 題目藍圖：以「歲時農耕・倉廩觀」作為 user-facing 唯一主隱喻
     - 採納 R4 風險鏈：Framework A/B 作為 internal 結構（對外輸出必須翻譯成農耕語彙）
   - **相關文件**：`docs/gem/runs/DECISION_P0-2_income_expansion_pressure_20260106.md`

3. **P0-3：跑 golden tests 固定輸入輸出**
   - **狀態**：✅ READY_TO_FREEZE（2026-01-09）
   - **關鍵成果**：
     - 完成敘事銳利度指標（R1_METRICS_V1_EXECUTABLE_SPEC.md）
     - 完成禁用詞表與高風險模板（R2_METAPHOR_BOUNDARY_BANLIST_HIGHRISK_TEMPLATES.md）
     - 建立 Golden Tests 和評分引擎
   - **關鍵決策**：建立敘事銳利度指標和禁用詞表，確保對外輸出符合「純玄學體驗」要求
   - **相關文件**：`P0-3/R1_METRICS_V1_EXECUTABLE_SPEC.md`、`P0-3/R2_METAPHOR_BOUNDARY_BANLIST_HIGHRISK_TEMPLATES.md`、`engine/score_facet.py`

4. **P0-4：Facet Portability & Stress Test**
   - **狀態**：✅ READY_TO_FREEZE（2026-01-09）
   - **關鍵成果**：驗證 P0-3 結構可在第二個 Facet（`relationship_imbalance`）上零改動搬移且不崩壞
   - **關鍵決策**：驗證結構的可移植性，確保設計的可擴充性
   - **相關文件**：`P0-4/P0-4_PORTABILITY_PLAN.md`、`P0-4/P0-4_GOLDEN_TESTS_SPEC.md`

5. **P0-4.5：題目流程與分流系統設計**
   - **狀態**：✅ COMPLETED（2026-01-10）
   - **關鍵成果**：完成 4 階段全像漏斗系統設計（八卦定方位 → 六親定物象 → 萬象定歸因 → 命盤綜合與斷語）
   - **關鍵決策**：設計一個能夠「涵蓋全人類、全年齡、全困擾、全困境」的多階段分流選擇系統
   - **相關文件**：`P0-4.5/P0-4.5_FUNNEL_SYSTEM_DESIGN.md`

6. **P0-5 結案報告：通用玄學介面協議 (UMIP)**
   - **狀態**：✅ CANONIZED（2026-01-10）
   - **關鍵成果**：
     - 完成 UMIP 規格定義（`P0-5/P0-5_UMIP_CLOSURE_REPORT.md` v1.0）
     - 完成 7 份 SPEC 文件（SPEC-1 ～ SPEC-7，共 3,136 行）
     - 完成 6 項 MVP Gate 驗收標準定義
   - **關鍵決策**：
     - 確立「後端科學極大化、前端玄學極致化」的二元架構
     - 去問卷化：廢除量表與表單，全面採用「羅盤凝視」與「單一物象選擇」
     - 儀式感介面：Stage 2 定案為「萬象羅盤（Radial Compass）」介面
     - 隱喻解耦：UI 框架轉型為通用播放器，讀取 JSON `theme_config` 切換視覺宇宙
   - **相關文件**：`P0-5/P0-5_UMIP_CLOSURE_REPORT.md` v1.0（開發與驗收的唯一依據）

#### 2.1.2 關鍵決策點

**為什麼做這個決定**：

1. **採用「歲時農耕・倉廩觀」作為第一個構面的主題（P0-2）**：
   - **背景**：需要選擇一個具體的構面來驗證整體架構
   - **決策依據**：R1 顧問師提供的題目藍圖，符合「東方玄學敘事」要求
   - **影響**：後續所有題目、敘事、建議都必須使用農耕語彙

2. **建立敘事銳利度指標和禁用詞表（P0-3）**：
   - **背景**：需要確保對外輸出符合「純玄學體驗」要求，不得暴露心理學名詞
   - **決策依據**：CHARTER 明確要求「使用者不需要、也不應該被告知任何心理學名詞」
   - **影響**：所有對外文案都必須通過 M3/M4 檢查，禁止使用禁用詞表

3. **設計 4 階段全像漏斗系統（P0-4.5）**：
   - **背景**：需要設計一個能夠「涵蓋全人類、全年齡、全困擾、全困境」的分流系統
   - **決策依據**：專案目標要求「適用於全世界、全文化、全人類、全年齡、全性別、全困擾、全問題場景」
   - **影響**：確立了 Stage 1–4 的整體流程，為 P0-5 UI 設計奠定基礎

4. **確立「萬象羅盤（Radial Compass）」作為 Stage 2 的 UI 實作型態（P0-5）**：
   - **背景**：需要明確 Stage 2 的具體 UI 形態，避免工程誤解
   - **決策依據**：符合「去問卷化」和「儀式性交互」的要求，避免列表/符碼雲的誤解
   - **影響**：明確了 Stage 2 的 UI 規格，為工程實作提供清晰指引

#### 2.1.3 專案整體狀態

**整體進度**：
- **當前階段**：Phase 0：MVP 核心功能（P0-5 工程實作階段）
- **整體完成度**：85.7%（6/7 階段完成，P0-5 工程實作為唯一未完成階段）
- **階段性目標**：
  - ✅ 已完成：P0-1 至 P0-4.5（設計階段全部完成）
  - ✅ 已完成：P0-5 結案報告已定案，7 份 SPEC 文件已完成
  - ⏳ 待完成：P0-5 工程實作（當前任務）

**整體決策脈絡**：
- **為什麼現在要執行這個任務**：P0-5 結案報告已定案，所有規格明確，可直接開始工程實作
- **與整體目標的關係**：
  - **真的能賺錢**：需要實際產品才能驗證商業可行性
  - **真的可以上國際**：需要實作 CN/EN 即時切換才能驗證國際化能力
  - **真的可以幫到人**：需要實際產品才能進行使用者驗證

**風險與挑戰**：
- **技術風險**：Stage 2 Radial Compass 的實現可能遇到技術難題（如算法實現、手機端適配）
- **時程風險**：工程實作可能超時（預估 2–4 週，實際可能需要更長時間）
- **品質風險**：實作品質可能不符合驗收標準（需持續測試和調整）

#### 2.1.4 未來規劃摘要

**短期任務清單**（接下來 2–4 週）：
1. **P0-5 工程實作**（P0 優先級，當前任務）
   - 預期時程：2–4 週
   - 關鍵交付物：UMIP Schema、Stage 2 Radial Compass、i18n 機制、高風險覆蓋機制、theme_config 讀取、L1–L4 分層呈現

**階段性規劃**：
- **當前階段**：Phase 0：MVP 核心功能（P0-5 工程實作）
- **下一個階段**：Phase 1：使用者驗證與效果測量（P1-1、P1-2、P1-3）
- **目標**：完成 MVP，為使用者驗證奠定基礎

**決策點**：
- **前端框架選擇**：需要在工程實作開始前決定（純 HTML/CSS/JS、React、Vue、Svelte 等）
- **項目結構**：需要決定是擴展 `prototype/` 還是新建 `ui/` 目錄
- **Stage 1 實作策略**：需要決定是「簡化為入口」還是「完全不實作」

#### 2.1.5 哪些方向已被否定或暫停

**已被否定的方向**（避免重複走老路）：
- ❌ **問卷式 UI**：已明確禁止量表/滑桿/表單式列表，必須使用「儀式性交互」
- ❌ **列表式 Stage 2**：已明確禁止矩形 Card Grid、List View，必須使用「萬象羅盤（Radial Compass）」
- ❌ **量化暗示**：已明確禁止 1–10、0%–100%、進度量表、Likert
- ❌ **硬編碼隱喻**：已明確禁止硬編碼單一隱喻，必須使用 `theme_config` 實現隱喻解耦
- ❌ **直接暴露內部數據**：已明確禁止前端 UI 接收/顯示未轉譯的內部心理量化資料
- ❌ **快照系統**：已轉換為 Cursor 架構，不再使用快照系統
- ❌ **副指揮官架構**：已轉換為任務執行者架構

**已暫停的方向**（可延後）：
- ⏸️ **完整 Stage 1 八卦轉輪**：根據結案報告，若資源不足可延後或簡化為入口
- ⏸️ **動畫細膩度優化**：P0-5 階段不追求完美動畫，只保留基本動畫效果
- ⏸️ **跨 Facet 選擇 UI**：P0-5 階段不實作跨 Facet 選擇介面
- ⏸️ **支付/帳號系統**：P0-6 占位，不優化

---

### 2.2 之前做過哪些相關嘗試（詳細回顧）

**已完成階段**：

- ✅ **P0-1**：選定第一個構面（Facet）
  - Facet ID: `income_expansion_pressure`（歲時農耕・倉廩觀）
  - 定義：薪資增速追不上家庭開銷所產生的壓力，以及對「第二收入」的驅動與可行性狀態
  - 完成日期：2026-01-06

- ✅ **P0-2**：建立該 facet 的 questions/scoring/reco/narr/risk
  - 採納 R1 題目藍圖：以「歲時農耕・倉廩觀」作為 user-facing 唯一主隱喻
  - 採納 R4 風險鏈：Framework A/B 作為 internal 結構（對外輸出必須翻譯成農耕語彙）
  - 完成 questions、scoring、recommendations、narratives、riskchains 數據結構
  - 完成日期：2026-01-07

- ✅ **P0-3**：跑 golden tests 固定輸入輸出
  - 完成敘事銳利度指標（R1_METRICS_V1_EXECUTABLE_SPEC.md）
  - 完成禁用詞表與高風險模板（R2_METAPHOR_BOUNDARY_BANLIST_HIGHRISK_TEMPLATES.md）
  - 建立 Golden Tests：`tests/run_golden.sh`、`tests/golden/expected_low.json`、`tests/golden/expected_high.json`
  - 完成評分引擎：`engine/score_facet.py`
  - 完成日期：2026-01-09

- ✅ **P0-4**：Facet Portability & Stress Test
  - 驗證 P0-3 結構可在第二個 Facet（`relationship_imbalance`）上零改動搬移且不崩壞
  - 完成隱喻治理與安全邊界驗證
  - 完成日期：2026-01-09

- ✅ **P0-4.5**：題目流程與分流系統設計
  - 完成 4 階段全像漏斗系統設計（八卦定方位 → 六親定物象 → 萬象定歸因 → 命盤綜合與斷語）
  - 完成分流系統規格：`P0-4.5/P0-4.5_FUNNEL_SYSTEM_DESIGN.md`
  - 完成日期：2026-01-10

- ✅ **P0-5 結案報告**：通用玄學介面協議 (UMIP) 已定案
  - 完成 UMIP 規格定義：`P0-5/P0-5_UMIP_CLOSURE_REPORT.md` v1.0
  - 完成 7 份 SPEC 文件（SPEC-1 ～ SPEC-7，共 3,136 行，品質 A 級）
  - 完成 6 項 MVP Gate 驗收標準定義
  - 完成 Stage 1–4 規格定義
  - 完成 L1–L4 規格定義
  - 完成日期：2026-01-10

**已有基礎原型**：
- ✅ `prototype/` 目錄提供了基礎的 UI 實作：
  - `index.html`：基礎 HTML 結構
  - `app.js`：數據讀取和題目渲染邏輯（可作為起點）
  - `styles.css`：基礎樣式
  - `README.md`：原型使用說明

**7 份 SPEC 文件詳細背景**：

根據 `P0-5/P0-5_TECHNICAL_SPEC_SUPPLEMENT_TASK_SUMMARY.md`，P0-5 技術規格設計階段已完成 7 份 SPEC 文件：

1. **SPEC-1：技術架構規格**（`P0-5/P0-5_TECHNICAL_ARCHITECTURE.md`）
   - 行數：462 行
   - 內容：整體架構圖、Adapter 詳解、資料流
   - 狀態：✅ 已完成

2. **SPEC-2：數據結構規格**（`P0-5/P0-5_DATA_STRUCTURE_SPEC.md`）
   - 行數：790 行
   - 內容：Schema 定義、i18n 結構
   - 狀態：✅ 已完成

3. **SPEC-3：實作指南**（`P0-5/P0-5_IMPLEMENTATION_GUIDE.md`）
   - 行數：485 行
   - 內容：完整目錄結構、i18n、Theme Engine、專案初始化步驟
   - 狀態：✅ 已完成

4. **SPEC-4：Stage 2 羅盤組件規格**（`P0-5/P0-5_COMPONENT_SPEC_COMPASS.md`）
   - 行數：328 行
   - 內容：完整算法公式、觸控事件處理、RWD 適配
   - 狀態：✅ 已完成

5. **SPEC-5：Risk 邏輯與結果呈現規格**（`P0-5/P0-5_LOGIC_SPEC_RISK_RESULT.md`）
   - 行數：394 行
   - 內容：RiskOverride Interceptor、Stage 3 詳細規格（重點）、L1–L4 揭示邏輯
   - 狀態：✅ 已完成

6. **SPEC-6：技術風險評估**（`P0-5/P0-5_TECHNICAL_RISKS.md`）
   - 行數：298 行
   - 內容：完整風險清單、緩解對策、對 MVP Gate 的影響
   - 狀態：✅ 已完成

7. **SPEC-7：測試策略**（`P0-5/P0-5_TESTING_STRATEGY.md`）
   - 行數：379 行
   - 內容：6 項 MVP Gate、測試工具配置、自動化掃描腳本
   - 狀態：✅ 已完成

**品質保證**：
- ✅ 文件完整性：7/7 (100%)
- ✅ 內容完整性：關鍵內容已全部涵蓋
- ✅ 可實作性：達到 Cursor-Executable 水準
- ✅ 風險評估：後期損壞/錯誤修改/需要補強風險均為「低」
- ✅ 可回滾權利：所有文件均標註「可修改」「可回滾」

### 2.2 哪些已完成、哪些卡住

**已完成的部分**：

- ✅ **規格定義**：P0-5 結案報告已定案，所有規格明確
- ✅ **數據結構**：`compiled_facet.json` Schema 已定義，已有實例數據
- ✅ **評分邏輯**：`engine/score_facet.py` 提供評分邏輯參考
- ✅ **基礎原型**：`prototype/` 提供基礎 UI 結構和數據讀取邏輯

**卡住或未完成的部分**：

- ❌ **UMIP Schema**：尚未建立 `UMIP_Schema_v1.json`（含 `theme_config`、`i18n` 欄位）
- ❌ **Stage 2 Radial Compass**：尚未實作「萬象羅盤」元件
- ❌ **i18n 機制**：尚未實作 CN/EN 即時切換機制（目前原型只有基礎的語言切換 UI，但無完整 i18n 架構）
- ❌ **高風險覆蓋機制**：尚未實作 `risk_level: HIGH` 時 L4 強制覆寫
- ❌ **theme_config 讀取**：尚未實作 `theme_config` 讀取與容錯機制
- ❌ **L1–L4 分層呈現**：尚未實作結果頁的分層揭示邏輯
- ❌ **視覺解耦驗證**：尚未驗證視覺解耦能力

**仍不確定的部分**：

- ❓ **前端框架選擇**：尚未決定使用哪個前端框架（純 HTML/CSS/JS、React、Vue、Svelte 等）
- ❓ **項目結構**：是擴展現有的 `prototype/` 還是新建 `ui/` 目錄？
- ❓ **測試策略**：如何測試 UI 的 6 項 MVP Gate 驗收標準？
- ❓ **Stage 1 實作策略**：根據結案報告，Stage 1 可以延後，但需要決定是「簡化為入口」還是「完全不實作」？

### 2.3 哪些方向已被否定或暫停

**已被否定的方向**：

- ❌ **問卷式 UI**：已明確禁止量表/滑桿/表單式列表，必須使用「儀式性交互」
- ❌ **列表式 Stage 2**：已明確禁止矩形 Card Grid、List View，必須使用「萬象羅盤（Radial Compass）」
- ❌ **量化暗示**：已明確禁止 1–10、0%–100%、進度量表、Likert
- ❌ **硬編碼隱喻**：已明確禁止硬編碼單一隱喻，必須使用 `theme_config` 實現隱喻解耦
- ❌ **直接暴露內部數據**：已明確禁止前端 UI 接收/顯示未轉譯的內部心理量化資料

**已暫停的方向**：

- ⏸️ **完整 Stage 1 八卦轉輪**：根據結案報告，若資源不足可延後或簡化為入口
- ⏸️ **動畫細膩度優化**：P0-5 階段不追求完美動畫，只保留基本動畫效果
- ⏸️ **跨 Facet 選擇 UI**：P0-5 階段不實作跨 Facet 選擇介面

---

## 三、目前已完成的結果或階段性結論

### 3.1 已完成的成果

#### 3.1.1 結案報告（唯一依據）

- ✅ **文件**：`P0-5/P0-5_UMIP_CLOSURE_REPORT.md` v1.0
- ✅ **狀態**：CANONIZED / REVISION-LOCKED (P0-5 Scope)
- ✅ **可用性**：✅ **可直接使用**（作為開發與驗收的唯一依據）
- ✅ **內容**：
  - 決策總綱：UMIP 架構原則與核心決策變更
  - 絕對紅線與硬規則：互動紅線、數據遮罩紅線、安全與合規紅線
  - 通用玄學介面架構：資料驅動視覺、Theme Config Fail-soft 原則
  - 四階段全像漏斗實作規格：Stage 1–4 的詳細規格
  - 結果頁面呈現規格：L1–L4 的分層呈現要求
  - P0-5 最小可交付合格線：6 項 MVP Gate 驗收標準
  - 下一步行動：工程端、設計端、內容端的具體任務

#### 3.1.2 數據結構與 Schema

- ✅ **Schema 文件**：`schemas/compiled_facet.schema.json`
  - 定義了 `compiled_facet.json` 的基本結構
  - 包含 `domainVersion`、`facetId`、`questions`、`scoring`、`recommendations`、`narratives`、`riskchains`
- ✅ **實例數據**：`domain/compiled/stress_recovery.compiled.v1.0.json`
  - 提供完整的實例數據參考
  - 包含 questions、scoring、recommendations、narratives、riskchains 的實際結構
- ✅ **評分引擎**：`engine/score_facet.py`
  - 提供評分邏輯參考
  - 示範如何從 `compiled_facet.json` 和 `answers.json` 計算 score 和 band

#### 3.1.3 基礎原型

- ✅ **原型文件**：`prototype/index.html`、`prototype/app.js`、`prototype/styles.css`
  - 提供基礎的 UI 結構和數據讀取邏輯
  - 包含基本的題目渲染和結果顯示邏輯
  - 包含基礎的語言切換 UI（但無完整 i18n 架構）

#### 3.1.4 設計規格文件

- ✅ **UI 架構設計**：`P0-5/P0-5_UI_ARCHITECTURE.md`
  - 提供整體 UI 架構哲學
  - 定義 Layer 0–6 的詳細規格
- ✅ **UI 串接規格**：`P0-5/P0-5_UI_INTEGRATION_SPEC.md`
  - 提供 UI 串接的技術規格
  - 定義數據流和可擴充性保證

#### 3.1.5 分流系統設計

- ✅ **分流系統設計**：`P0-4.5/P0-4.5_FUNNEL_SYSTEM_DESIGN.md`
  - 完成 4 階段全像漏斗系統設計
  - 定義 Stage 1–4 的整體流程

#### 3.1.6 敘事規格與安全規範

- ✅ **敘事銳利度指標**：`P0-3/R1_METRICS_V1_EXECUTABLE_SPEC.md`
  - 定義禁用詞表（M3/M4 檢查）
  - 定義玄學轉譯規則
- ✅ **禁用詞表與高風險模板**：`P0-3/R2_METAPHOR_BOUNDARY_BANLIST_HIGHRISK_TEMPLATES.md`
  - 定義對外禁用詞（Machine-Checkable Ban List）
  - 定義 R4 高風險 L4 固定模板（Template A/B）

### 3.2 暫時可用的資源

#### 3.2.1 基礎原型（可作為起點）

- 🔄 **說明**：`prototype/` 提供基礎的 UI 結構和數據讀取邏輯，可作為工程實作的起點
- 🔄 **限制**：
  - 無完整的 i18n 架構（只有基礎的語言切換 UI）
  - 無 Stage 2 Radial Compass 實作
  - 無 L1–L4 分層呈現邏輯
  - 無 `theme_config` 讀取機制
  - 無高風險覆蓋機制
- 🔄 **建議**：可以基於此原型擴展，或新建更完整的 UI 結構

#### 3.2.2 評分引擎（可作為參考）

- 🔄 **說明**：`engine/score_facet.py` 提供評分邏輯參考，可作為前端評分邏輯的參考
- 🔄 **限制**：這是 Python 後端邏輯，前端需要重新實作 JavaScript 版本
- 🔄 **建議**：可以參考其邏輯，但在前端實作時需要考慮不同的數據結構和流程

### 3.3 仍不確定的部分

#### 3.3.1 前端框架選擇

- ❓ **問題**：尚未決定使用哪個前端框架
- ❓ **選項**：
  - 純 HTML/CSS/JavaScript（最簡單，與現有原型一致）
  - React（生態系統完善，組件化）
  - Vue（易學易用，漸進式）
  - Svelte（編譯時優化，體積小）
  - 其他框架
- ❓ **建議**：根據專案需求和團隊技術棧選擇，但需考慮「可運作、可測試」原則

#### 3.3.2 項目結構

- ❓ **問題**：是擴展現有的 `prototype/` 還是新建 `ui/` 目錄？
- ❓ **選項**：
  - 擴展 `prototype/`（保持一致性，但可能與「原型」語義不符）
  - 新建 `ui/` 或 `umip/` 目錄（更清晰，但需要遷移現有代碼）
- ❓ **建議**：根據實際需要決定，但需符合文件放置規範

#### 3.3.3 測試策略

- ❓ **問題**：如何測試 UI 的 6 項 MVP Gate 驗收標準？
- ❓ **需要確認**：
  - 是否需要自動化測試（E2E、單元測試）？
  - 如何測試 CN/EN 即時切換？
  - 如何測試 `risk_level: HIGH` 覆蓋機制？
  - 如何測試視覺解耦能力？
- ❓ **建議**：至少需要手動測試清單，可選自動化測試

#### 3.3.4 Stage 1 實作策略

- ❓ **問題**：根據結案報告，Stage 1 可以延後，但需要決定具體策略
- ❓ **選項**：
  - 完全不實作（直接進入 Stage 2）
  - 簡化為「直接進入 Stage 2」的入口按鈕
  - 實作基礎的八卦轉輪（若資源允許）
- ❓ **建議**：根據實際資源決定，但需保留可擴展接口

---

## 四、本次希望推進的下一個目標

### 4.1 當前階段目標

**本次任務包要達成什麼**：

> 根據已定案的 UMIP 結案報告（`P0-5/P0-5_UMIP_CLOSURE_REPORT.md` v1.0），實作完整的 UI 整合方案，滿足 6 項 MVP Gate 驗收標準，實現從 `compiled_facet.json` 到使用者體驗的完整流程。

### 4.2 推進方向

**可以模糊，但要有方向**：

- **想補強哪一段**：
  - 補強現有原型的缺失功能（i18n、Stage 2 Radial Compass、L1–L4 分層呈現、高風險覆蓋機制、theme_config 讀取）
  - 補強數據處理邏輯（從 `compiled_facet.json` 到 UI 渲染的完整流程）
  - 補強驗收測試（確保 6 項 MVP Gate 驗收標準全部滿足）
- **想擴展還是收斂**：
  - **收斂**：專注於滿足 6 項 MVP Gate 驗收標準，不追求完美動畫或額外功能
  - **收斂**：若資源不足，可延後 Stage 1 實作，專注於 Stage 2–4 和結果呈現
- **想驗證某個假設，還是單純找靈感**：
  - **驗證假設**：驗證 UMIP 協議的可行性
  - **驗證假設**：驗證「隱喻解耦」架構能否真正實現（通過 `theme_config` 切換視覺宇宙）
  - **驗證假設**：驗證「去問卷化」的儀式性交互能否提供更好的使用者體驗
  - **驗證假設**：驗證 CN/EN 即時切換的技術可行性

### 4.3 預期成果

#### 4.3.1 核心交付物（必須完成）

1. **UMIP_Schema_v1.json**
   - 位置：`schemas/umip_schema_v1.json`（新建）
   - 內容：含 `theme_config`、`i18n` 欄位與必要 fallback 約束
   - 狀態：必須完成

2. **Stage 2「Radial Compass」元件**
   - 位置：新建 UI 代碼中
   - 內容：放射狀羅盤/星盤介面，支援 20–30 個符碼，支援選取流程
   - 手機端適配：可撥動轉輪/旋盤模式
   - 狀態：必須完成（硬性要求）

3. **i18n 機制**
   - 位置：新建 UI 代碼中
   - 內容：CN/EN 即時切換機制（不 reload），所有靜態/動態文本可切換
   - 狀態：必須完成（硬性要求）

4. **高風險覆蓋機制**
   - 位置：新建 UI 代碼中
   - 內容：`risk_level: HIGH` 時 L4 強制覆寫，顯示安全模板（Template A/B）
   - 狀態：必須完成

5. **theme_config 讀取與容錯機制**
   - 位置：新建 UI 代碼中
   - 內容：讀取 `theme_config`，實現視覺解耦，具備 fallback 機制
   - 狀態：必須完成

6. **L1–L4 分層呈現邏輯**
   - 位置：新建 UI 代碼中
   - 內容：結果頁分層揭示 L1 → L2 → L3 → L4，遵守遮罩紅線
   - 狀態：必須完成

#### 4.3.2 可選交付物（根據資源決定）

7. **Stage 1 八卦轉輪**（可選）
   - 內容：基礎的八卦轉輪或星圖介面
   - 狀態：可延後或簡化為入口

8. **自動化測試**（可選）
   - 內容：E2E 測試或單元測試，驗證 6 項 MVP Gate 驗收標準
   - 狀態：可選，但至少需要手動測試清單

9. **無隱喻線框圖**（設計端，可選）
   - 內容：證明 UI 可套用農耕/海洋/星際等不同皮層
   - 狀態：可選，但建議完成

#### 4.3.3 測試與驗收

10. **驗收測試報告**
    - 位置：`P0-5/P0-5_IMPLEMENTATION_ACCEPTANCE_REPORT.md`（新建）
    - 內容：驗證 6 項 MVP Gate 驗收標準的達成情況
    - 狀態：必須完成

---

## 五、思考與產出期待（取代角色設定）

### 5.1 期望的思考方式

**重點不是固定角色，而是思考方式與產出期待**：

- **可以專業、抽象、跨領域**：
  - 前端工程師 + UI/UX 設計師 + 內容策略師的混合視角
  - 理解「後端科學極大化、前端玄學極致化」的二元架構
  - 理解「隱喻解耦」和「儀式性交互」的設計哲學
- **不必保守**：
  - 可以嘗試創新的 UI 交互方式（符合 UMIP 規格的前提下）
  - 可以提出技術實現的優化建議
  - 可以質疑現有設計，提出改進方案
- **不要求一次定稿**：
  - 可以先實作 MVP 版本，再迭代優化
  - 可以先實作核心功能，再補強細節
  - 可以並行探索多個技術方案，根據測試結果選擇最佳方案
- **可以多版本並存**：
  - 可以同時探索不同的前端框架方案
  - 可以同時探索不同的 UI 組件實作方式
  - 可以保留備選方案，方便後續切換

### 5.2 期望的產出內容

#### 5.2.1 工程端（Engineering）

**UMIP Schema 設計**：
- 設計 `UMIP_Schema_v1.json`，定義 `theme_config`、`i18n` 欄位的完整結構
- 考慮 fallback 機制和容錯處理
- 考慮與現有 `compiled_facet.schema.json` 的兼容性

**Stage 2 Radial Compass 實作**：
- 實作放射狀羅盤/星盤介面
- 支援 20–30 個符碼的顯示和選取
- 支援符碼點亮和吸附至中央的動畫
- 實作手機端旋盤適配（可撥動轉輪模式）

**i18n 機制實作**：
- 設計 i18n 架構（JSON 文件結構、切換機制）
- 實作 CN/EN 即時切換（不 reload）
- 確保所有靜態文本和動態文本都可切換
- 確保英文敘事具原生語感（不得逐字翻譯腔）

**高風險覆蓋機制實作**：
- 實作 `risk_level: HIGH` 檢測邏輯
- 實作 L4 強制覆寫機制（忽略動態生成的 L4，使用安全模板）
- 實作安全模板（Template A/B）的 CN/EN 版本

**theme_config 讀取與容錯**：
- 實作 `theme_config` 讀取邏輯
- 實作 fallback 機制（缺值回退到「中性玄學皮層」）
- 實作資產容錯（載入失敗不阻斷流程）
- 驗證視覺解耦能力（切換 `theme_config` 可改變視覺風格）

**L1–L4 分層呈現邏輯**：
- 實作結果頁的分層揭示邏輯（L1 → L2 → L3 → L4）
- 實作 L3 主動揭示機制（點擊/長按/展開）
- 實作數據遮罩（不顯示未轉譯的內部數據）
- 實作 L4 姿態化語氣檢查（「宜/不宜/守/攻」語感）

**數據處理邏輯**：
- 實作從 `compiled_facet.json` 讀取和解析的邏輯
- 實作評分邏輯（JavaScript 版本，參考 `engine/score_facet.py`）
- 實作 outcome band 選擇邏輯
- 實作 narratives、recommendations、riskchains 的渲染邏輯

#### 5.2.2 設計端（Design，可選但建議）

**無隱喻線框圖**：
- 產出「無隱喻線框圖（Metaphor-Free Wireframe）」
- 證明 UI 可套用農耕/海洋/星際等不同皮層仍成立
- 展示 `theme_config` 切換視覺風格的能力

**Stage 2 羅盤互動原型**：
- 製作 Stage 2 Radial Compass 的互動原型
- 驗證放射狀布局與互動邏輯
- 驗證手機端旋盤適配的可行性

**英文排版溢出檢查**：
- 執行英文排版溢出檢查（Overflow Check）
- 確保 CN/EN 切換時無排版問題
- 確保英文文本在羅盤、卡片等元件中正確顯示

#### 5.2.3 測試與驗收

**驗收測試**：
- 建立 6 項 MVP Gate 驗收標準的測試清單
- 手動執行驗收測試，記錄結果
- 產出驗收測試報告（`P0-5/P0-5_IMPLEMENTATION_ACCEPTANCE_REPORT.md`）

**自動化測試**（可選）：
- 建立 E2E 測試或單元測試
- 自動化驗證 6 項 MVP Gate 驗收標準
- 建立 CI/CD 流程，確保代碼品質

### 5.3 思考與產出的範例

#### 5.3.1 技術實現評估

**範例：Stage 2 Radial Compass 實作方案評估**

**思考方式**：
- 評估不同的技術方案（Canvas、SVG、CSS + JavaScript、WebGL）
- 考慮性能、兼容性、可維護性、開發效率
- 考慮手機端適配的技術可行性
- 提出最優方案並說明理由

**產出內容**：
- 技術方案評估文件（含優缺點對比）
- 選定的技術方案及理由
- 實作計劃（含里程碑和時間估計）

#### 5.3.2 UI 整合設計

**範例：L1–L4 分層呈現的 UI 設計**

**思考方式**：
- 理解「批命」的儀式感要求
- 設計分層揭示的視覺效果和互動方式
- 確保遵守數據遮罩紅線（不顯示未轉譯的內部數據）
- 確保 L4 姿態化語氣的正確呈現

**產出內容**：
- UI 設計草圖或線框圖
- 分層揭示的互動流程設計
- 視覺效果和動畫方案

#### 5.3.3 內容與敘事整合

**範例：i18n 架構設計**

**思考方式**：
- 理解「英文敘事需具原生語感」的要求
- 設計 i18n JSON 文件結構（含 CN/EN 對應關係）
- 考慮動態內容（narratives、recommendations、riskchains）的 i18n 處理
- 考慮靜態內容（按鈕、標籤、錯誤訊息）的 i18n 處理

**產出內容**：
- i18n 架構設計文件
- i18n JSON 文件範例
- i18n 切換機制的實作方案

---

## 六、關鍵技術規格與約束（來自結案報告）

### 6.1 絕對紅線（任何違反皆視為 Bug）

#### 6.1.1 互動紅線

- ❌ **禁止捲動式長問卷**：必須一屏一問（One Screen, One Query）
- ❌ **禁止量化暗示**：嚴禁出現 1–10、0%–100%、進度量表、Likert
- ❌ **禁止引導評分**：選項必須是「狀態/畫面/象」，不得引導使用者「評分自己」

#### 6.1.2 數據遮罩紅線

- ❌ **禁止暴露內部數據**：前端 UI **永遠不可接收/不可顯示**未轉譯的內部心理量化資料（Severity、Attribution、Coping）
- ✅ **僅供顯影**：UI 只讀取 `compiled_facet.json` 的「對外封裝輸出」（如 `narrative_text`、`visual_assets`、`theme_config` 等）

#### 6.1.3 安全與合規紅線

- ❌ **禁止指令化呈現**：禁止 checkbox、bullet points、To-Do 清單樣式；必須以卡片/籤詩/箴言呈現
- ✅ **高風險強制覆蓋**：當 `risk_level: HIGH` 時，UI 必須忽略動態 L4，**強制渲染** R4 指定的靜態安全模板（Template A/B）

### 6.2 技術實現要求

#### 6.2.1 Stage 2 萬象羅盤（硬性要求）

**UI 結構**：放射狀羅盤/星盤介面（Radial Symbol Map）

**元素規格**：
- 盤面呈現 **20–30 個微縮符碼**（例：印、官、財、煞、馬、權、情、緣、傷、貴…）
- 符碼分布於**同心圓軌道**上（3–5 層軌道）
- 每個符碼可配置視覺樣式（圖示、顏色、動畫）

**操作邏輯**：
- **指令**：「凝視盤面，點擊此刻映入眼簾的 [N] 個徵兆。」（N 可設定為 2–3）
- **選取**：點擊後符碼點亮，並吸附/飛入中央太極區形成選集
- **確認**：選取完成後進入 Stage 3

**RWD 適配**：
- **桌面端**：完整羅盤顯示
- **手機端**：可撥動轉輪/旋盤模式取代縮小盤面
- **平板端**：適配中間尺寸

**禁止**：嚴禁矩形 Card Grid、List View、表單式清單

#### 6.2.2 CN/EN 即時切換（硬性要求）

**技術要求**：
- 必須支援**即時切換**，不需重新載入頁面（no reload）
- 所有文字（題目、結果、按鈕、UI 標籤）都需即時更新
- **英文敘事需具原生語感**（不得逐字翻譯腔）
- 數據結構中應包含 `zh` 和 `en` 欄位，UI 根據當前語言選擇對應欄位

**測試方法**：手動切換語言，驗證所有文本即時更新且無遺漏

#### 6.2.3 theme_config 讀取與容錯（硬性要求）

**Fail-soft 原則**：
- **缺值回退**：若 `theme_config` 缺失，UI 必須降級使用內建「中性玄學皮層（Neutral Ritual Skin）」
- **資產容錯**：任何視覺資產載入失敗不得阻斷流程，只能停用該效果
- **邏輯隔離**：`theme_config` 僅控制視覺皮層，嚴禁影響文案結構與敘事順序

**驗證要求**：不改前端程式碼情況下，僅修改 JSON `theme_config` 即可切換基本視覺元素（至少背景/字體/配色任一生效）

#### 6.2.4 L1–L4 分層呈現（硬性要求）

**揭示順序**：必須遵循 **L1 → L2 → L3 → L4** 順序

**L1：天象/定調**：
- UI：全螢幕背景氛圍變化
- 多樣性要求：同 Outcome Band 下至少 **3 組天象描述**，前端可隨機輪播

**L2：物象/主敘事**：
- UI：核心視覺焦點
- 文案要求：使用**高銳利度名詞**（如裂痕、發霉、潰決），避免抽象形容詞

**L3：干擾/盲點**：
- UI：次級資訊層
- 互動要求：必須由使用者**主動揭示**（點擊/長按/展開），隱喻「撥霧」

**L4：姿態/儀式**：
- UI：籤詩/錦囊式卡片
- 語氣限制：只允許「宜… / 不宜… / 守… / 攻…」姿態語氣；不得呈現成待辦或命令
- **高風險鎖定**：當 `risk_level: HIGH` 時鎖定 L4，顯示安全語句（CN/EN 對應版本）

---

## 七、6 項 MVP Gate 驗收標準（必須全部滿足）

### 7.1 驗收標準清單

根據 `P0-5/P0-5_UMIP_CLOSURE_REPORT.md` v1.0 第 6 章，P0-5 被視為「完成」，必須同時滿足以下 **6 項**驗收標準：

#### ✅ 驗收標準 #1：資料串接

- **要求**：UI 可正確載入並解析任一符合 Schema 的 `compiled_facet.json`
- **測試方法**：
  - 載入 `domain/compiled/stress_recovery.compiled.v1.0.json`
  - 驗證所有字段（questions、scoring、recommendations、narratives、riskchains）正確解析
  - 驗證基本的容錯能力（fallback 值）
- **通過標準**：UI 能正確讀取並顯示 `compiled_facet.json` 的內容，無錯誤

#### ✅ 驗收標準 #2：CN/EN 雙語即時切換（硬性要求）

- **要求**：必須支援**即時切換**，不需重新載入頁面（no reload）
- **測試方法**：
  - 手動切換語言（CN ↔ EN）
  - 驗證所有文字（題目、結果、按鈕、UI 標籤）即時更新
  - 驗證英文敘事具原生語感（不得逐字翻譯腔）
- **通過標準**：所有文本即時切換，無遺漏，英文敘事自然流暢

#### ✅ 驗收標準 #3：儀式介面（Stage 2 硬性）

- **要求**：成功實作「萬象羅盤（Radial Compass）」並可完成選取流程
- **測試方法**：
  - 驗證羅盤介面正確顯示（20–30 個符碼，同心圓軌道）
  - 驗證符碼選取功能（點擊後點亮並吸附至中央）
  - 驗證手機端旋盤適配基本可用
- **通過標準**：至少支援 2–3 個符碼選取，選取流程順暢，手機端適配可用

#### ✅ 驗收標準 #4：結果呈現

- **要求**：Stage 4 結果頁完整呈現 L1–L4；且所有開發用數據皆不可見（遵守遮罩紅線）
- **測試方法**：
  - 驗證 L1–L4 分層呈現邏輯（L1 → L2 → L3 → L4）
  - 驗證 L3 主動揭示機制（點擊/長按/展開）
  - 驗證不顯示未轉譯的內部數據（Severity、Attribution、Coping 等）
- **通過標準**：L1–L4 完整呈現，無內部數據洩露

#### ✅ 驗收標準 #5：風險覆蓋

- **要求**：可人工模擬 `risk_level = HIGH`，並驗證 L4 會被安全模板強制覆寫
- **測試方法**：
  - 人工設置 `risk_level: HIGH`（可在 `compiled_facet.json` 中設定或通過 UI 模擬）
  - 驗證 L4 顯示安全語句（CN：「宜暫停自判，轉向外部守護者。」EN：「Seek an external keeper of balance.」）
  - 驗證動態生成的 L4 被忽略
- **通過標準**：高風險時 L4 正確顯示安全模板，動態 L4 被覆寫

#### ✅ 驗收標準 #6：視覺解耦

- **要求**：不改前端程式碼情況下，僅修改 JSON `theme_config` 即可切換基本視覺元素（至少背景/字體/配色任一生效）
- **測試方法**：
  - 準備兩組不同的 `theme_config`（例如：農耕主題 vs 海洋主題）
  - 在不修改前端程式碼的情況下，切換 `theme_config`
  - 驗證視覺風格正確切換（背景/字體/配色至少一項生效）
- **通過標準**：切換 `theme_config` 後，視覺風格正確變化，證明隱喻解耦能力

### 7.2 驗收測試報告格式

驗收測試完成後，需產出 `P0-5/P0-5_IMPLEMENTATION_ACCEPTANCE_REPORT.md`，包含：

- 每項驗收標準的測試結果（✅ 通過 / ❌ 失敗）
- 測試方法與步驟記錄
- 截圖或錄影證明（可選但建議）
- 已知問題與後續改進計劃

---

## 八、相關文件索引（完整參考資料）

### 8.1 核心文件（必讀）

- **結案報告**：`P0-5/P0-5_UMIP_CLOSURE_REPORT.md` v1.0（**開發與驗收的唯一依據**）
- **專案憲章**：`charter/CHARTER.md`（專案最高目標與核心價值）
- **專案路線圖**：`roadmap/ROADMAP.md`（整體進度與階段目標）
- **文件放置規範**：`docs/governance/CURSOR_FILE_PLACEMENT_RULE.md`（文件組織規則）

### 8.2 階段相關文件

- **P0-5 任務包**：`P0-5/P0-5_TASK_PACKET.md` v2.0（階段任務包，提供背景與歷史狀態）
- **P0-5 階段日誌**：`P0-5/P0-5_PHASE_LOG.md`（階段執行記錄）
- **P0-5 交接摘要**：`P0-5/P0-5_HANDOFF_SUMMARY.md`（階段交接資訊）
- **P0-5 結案摘要**：`P0-5/P0-5_CLOSURE_SUMMARY.md`（快速搜索索引）

### 8.3 設計規格文件

- **UI 架構設計**：`P0-5/P0-5_UI_ARCHITECTURE.md`（整體 UI 架構哲學）
- **UI 串接規格**：`P0-5/P0-5_UI_INTEGRATION_SPEC.md`（UI 串接技術規格）
- **分流系統設計**：`P0-4.5/P0-4.5_FUNNEL_SYSTEM_DESIGN.md`（4 階段全像漏斗系統設計）

### 8.4 數據結構與 Schema

- **Compiled Facet Schema**：`schemas/compiled_facet.schema.json`（基本結構定義）
- **Compiled Facet 實例**：`domain/compiled/stress_recovery.compiled.v1.0.json`（實例數據參考）
- **評分引擎**：`engine/score_facet.py`（評分邏輯參考）

### 8.5 敘事規格與安全規範

- **敘事銳利度指標**：`P0-3/R1_METRICS_V1_EXECUTABLE_SPEC.md`（禁用詞表與玄學轉譯規則）
- **禁用詞表與高風險模板**：`P0-3/R2_METAPHOR_BOUNDARY_BANLIST_HIGHRISK_TEMPLATES.md`（對外禁用詞與 R4 高風險模板）

### 8.6 基礎原型

- **原型文件**：`prototype/index.html`、`prototype/app.js`、`prototype/styles.css`、`prototype/README.md`
- **原型說明**：提供基礎的 UI 結構和數據讀取邏輯，可作為起點

### 8.7 測試相關

- **Golden Tests**：`tests/run_golden.sh`、`tests/golden/expected_low.json`、`tests/golden/expected_high.json`（後端評分邏輯測試，可作為參考）

### 8.8 治理文件

- **AI 協作框架**：`docs/governance/CURSOR_GPT_GEMINI_COLLABORATION_FRAMEWORK.md`（AI 協作規則）
- **AI 顧問角色**：`docs/governance/AI_ADVISORY_ROLES.md`（顧問角色定義）

---

## 九、後續擴展與優化空間（不凍結，保留修改空間）

### 9.1 可延後的功能

根據 `P0-5/P0-5_UMIP_CLOSURE_REPORT.md` v1.0 第 6 章「不包含於 P0-5 合格線的項目」：

- **動畫細膩度優化**：P0-5 階段不追求完美動畫，只保留基本動畫效果
- **完整 Stage 1 八卦轉輪實作**：若時間不足，可簡化為「直接進入 Stage 2」的入口
- **支付/帳號系統**：P0-6 占位，不優化
- **跨 Facet 選擇 UI**：P0-5 階段不實作跨 Facet 選擇介面
- **使用者資訊收集的完整驗證**：可先做基本表單，完整驗證延後
- **豐富的視覺效果與動畫**：基本動畫可保留，豐富效果延後
- **結果分享功能**：可延後實作

### 9.2 可持續優化的方向

- **性能優化**：代碼壓縮、資源懶加載、渲染優化
- **可訪問性（A11y）**：鍵盤導航、螢幕閱讀器支援、色彩對比度
- **國際化擴展**：支援更多語言（日文、韓文、西班牙文等）
- **動畫細節**：更流暢的過場動畫、更精緻的視覺效果
- **測試覆蓋率**：自動化測試、E2E 測試、性能測試

---

## 十、附錄：技術決策記錄（建議）

### 10.1 待決策事項

#### 10.1.1 前端框架選擇

**問題**：使用哪個前端框架？

**選項**：
- 純 HTML/CSS/JavaScript（最簡單，與現有原型一致）
- React（生態系統完善，組件化）
- Vue（易學易用，漸進式）
- Svelte（編譯時優化，體積小）

**建議**：根據專案需求和團隊技術棧選擇，但需考慮「可運作、可測試」原則

#### 10.1.2 項目結構

**問題**：是擴展現有的 `prototype/` 還是新建 `ui/` 目錄？

**選項**：
- 擴展 `prototype/`（保持一致性，但可能與「原型」語義不符）
- 新建 `ui/` 或 `umip/` 目錄（更清晰，但需要遷移現有代碼）

**建議**：根據實際需要決定，但需符合文件放置規範

#### 10.1.3 Stage 1 實作策略

**問題**：Stage 1 的實作策略是什麼？

**選項**：
- 完全不實作（直接進入 Stage 2）
- 簡化為「直接進入 Stage 2」的入口按鈕
- 實作基礎的八卦轉輪（若資源允許）

**建議**：根據實際資源決定，但需保留可擴展接口

### 10.2 技術實現建議

#### 10.2.1 Stage 2 Radial Compass 實作建議

**技術方案選項**：
- **Canvas + JavaScript**：靈活度高，適合複雜動畫，但代碼較多
- **SVG + CSS/JavaScript**：向量圖形，縮放不失真，易於控制
- **CSS + JavaScript**：最簡單，但可能無法滿足複雜的羅盤布局
- **WebGL**：性能最佳，適合大量元素，但學習曲線較陡

**建議**：先評估 SVG 方案，若無法滿足需求再考慮 Canvas 或 WebGL

#### 10.2.2 i18n 架構設計建議

**架構選項**：
- **JSON 文件結構**：`i18n/zh.json`、`i18n/en.json`（最簡單）
- **嵌套結構**：`i18n/zh/ui.json`、`i18n/zh/content.json`、`i18n/en/ui.json`、`i18n/en/content.json`（更清晰）
- **動態載入**：按需載入語言文件（性能優化）

**建議**：先採用 JSON 文件結構，後續可優化為嵌套結構或動態載入

---

**本任務包版本**：v1.0  
**建立日期**：2026-01-10  
**狀態**：ACTIVE | EDITABLE | REFERENCE（非硬性、可隨時修正）

**— 本任務包遵循 `docs/governance/CURSOR_GPT_GEMINI_COLLABORATION_FRAMEWORK.md` 與 `docs/governance/CURSOR_FILE_PLACEMENT_RULE.md` 規範。**

**— 本任務包基於 `P0-5/P0-5_UMIP_CLOSURE_REPORT.md` v1.0（開發與驗收的唯一依據）。**

