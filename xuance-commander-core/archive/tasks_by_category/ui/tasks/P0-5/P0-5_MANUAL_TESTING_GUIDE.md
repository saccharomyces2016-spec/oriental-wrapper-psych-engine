# P0-5 人工測試指南

**測試日期**：2026-01-11  
**測試網址**：http://localhost:5173/  
**測試目標**：驗證所有修復和核心功能

---

## 一、測試前準備

### 1.1 確認開發伺服器運行

```bash
# 確認伺服器運行
curl http://localhost:5173/ 

# 如果未運行，啟動伺服器
cd xuance-commander-core/ui
npm run dev
```

### 1.2 打開瀏覽器開發者工具

- 開啟 Chrome/Firefox/Safari 開發者工具（F12 或 Cmd+Option+I）
- 切換到 Console 標籤
- 檢查是否有錯誤或警告訊息

---

## 二、核心功能測試（必須測試）

### 2.1 Gate #1：資料串接測試

**測試步驟**：
1. 打開 http://localhost:5173/
2. 檢查頁面是否正常載入（無白屏）
3. 檢查 Console 是否有載入錯誤
4. 檢查 Network 標籤，確認 `/data/compiled_facet.json` 載入成功（狀態 200）

**預期結果**：
- ✅ 頁面正常顯示
- ✅ 圓盤符碼正常顯示
- ✅ 無載入錯誤

**測試狀態**：□ 通過 □ 失敗

---

### 2.2 Gate #2：CN/EN 即時切換測試

**測試步驟**：
1. 觀察初始頁面語言（應該是中文）
2. 點擊右上角「EN」按鈕
3. 檢查以下元素是否立即切換為英文（不需重新載入）：
   - 圓盤引導文字（"Gaze at the compass, tap the 3 signs that catch your eye."）
   - 符碼名稱（如 "Heaven", "Earth", "Wealth" 等）
   - 確認按鈕文字（"Confirm"）
4. 點擊「中文」按鈕
5. 檢查所有文字是否立即切換回中文

**測試項目**：
- [ ] 語言切換按鈕可見且可點擊
- [ ] 點擊後頁面不重新載入（無刷新）
- [ ] 所有文字立即更新
- [ ] 符碼名稱正確翻譯
- [ ] 按鈕文字正確翻譯
- [ ] 引導文字正確翻譯
- [ ] 狀態保留（選取的符碼不會消失）

**預期結果**：
- ✅ 即時切換，無 reload
- ✅ 所有文字正確翻譯
- ✅ 狀態保留正常

**測試狀態**：□ 通過 □ 失敗

---

### 2.3 Gate #3：儀式介面（Stage 2）測試

#### 2.3.1 視覺檢查

**測試步驟**：
1. 檢查圓盤是否正常顯示
2. 檢查符碼分布是否合理（3 層軌道：INNER、MIDDLE、OUTER）
3. 檢查符碼文字是否清晰可讀
4. 檢查是否有文字重疊問題

**測試項目**：
- [ ] 圓盤正常顯示
- [ ] 符碼分布合理（約 20-30 個符碼）
- [ ] 文字清晰可讀
- [ ] 無明顯重疊（輕微重疊可接受）

**測試狀態**：□ 通過 □ 失敗

#### 2.3.2 互動功能測試

**測試步驟**：
1. **點擊測試（重點：已修復的點擊範圍）**
   - 嘗試點擊圓點（灰色小圓圈）
   - 嘗試點擊文字標籤（如「陰」、「陽」、「財」等）
   - 確認兩種方式都能選取符碼

2. **選取計數測試**
   - 點擊第一個符碼，檢查頂部計數是否從 0/3 變為 1/3
   - 點擊第二個符碼，檢查計數是否變為 2/3
   - 點擊第三個符碼，檢查計數是否變為 3/3

3. **取消選取測試**
   - 點擊已選取的符碼，確認可以取消選取
   - 檢查計數是否正確減少

4. **最大選取數測試**
   - 選滿 3 個符碼後，點擊第 4 個符碼
   - 檢查是否移除第一個選取的符碼（FIFO 行為）

5. **確認按鈕測試（重點：已修復的可見性）**
   - 選滿 3 個符碼後，檢查確認按鈕是否：
     - 按鈕變為可用狀態（不再是灰色 disabled）
     - 按鈕可見（不需要捲動就能看到，或使用 sticky 定位）
   - 未選滿 3 個時，確認按鈕應為 disabled 狀態

**測試項目**：
- [ ] 點擊圓點可以選取
- [ ] 點擊文字可以選取（**重要：這是已修復的功能**）
- [ ] 計數正確更新（0/3 → 1/3 → 2/3 → 3/3）
- [ ] 可以取消選取
- [ ] 超過最大數時正確處理（FIFO）
- [ ] 確認按鈕狀態正確（disabled/enabled）
- [ ] 確認按鈕可見（**重要：已修復**）
- [ ] 確認按鈕可點擊（選滿 3 個後）

**預期結果**：
- ✅ 點擊範圍足夠大（圓點和文字都可點擊）
- ✅ 計數正確更新
- ✅ 確認按鈕可見且狀態正確

**測試狀態**：□ 通過 □ 失敗

#### 2.3.3 流程跳轉測試

**測試步驟**：
1. 選取 3 個符碼
2. 點擊確認按鈕
3. 檢查是否進入 Stage 3（投射問題頁面）

**測試項目**：
- [ ] 點擊確認後進入 Stage 3
- [ ] Stage 3 頁面正常顯示

**測試狀態**：□ 通過 □ 失敗

---

### 2.4 Gate #4：結果呈現（Stage 4）測試

#### 2.4.1 進入 Stage 4

**測試步驟**：
1. 從 Stage 2 選取 3 個符碼，點擊確認
2. 在 Stage 3 選擇一個選項（Option 1 或 Option 2）
3. 檢查是否進入 Stage 4（結果頁面）

**測試項目**：
- [ ] Stage 3 正常顯示
- [ ] 選擇選項後進入 Stage 4

**測試狀態**：□ 通過 □ 失敗

#### 2.4.2 L1-L4 層級呈現測試

**測試步驟**：
1. **L1（天象/定調）測試**
   - 檢查 L1 是否立即顯示
   - 檢查標題是否正確（中文：「此時天象為大旱，倉廩微裂」）

2. **L2（物象/主敘事）測試**
   - 等待約 2 秒
   - 檢查 L2 是否自動顯示
   - 檢查標題和內容是否正確

3. **L3（干擾/盲點）測試**
   - 檢查 L3 是否顯示標題
   - 檢查是否有展開/收起按鈕（箭頭圖示）
   - 點擊展開按鈕
   - 檢查內容是否顯示
   - 檢查箭頭是否從 ▼ 變為 ▲

4. **L4（姿態/儀式）測試**
   - 檢查 L4 是否在 L3 展開後顯示
   - 檢查標題和內容是否正確

**測試項目**：
- [ ] L1 立即顯示
- [ ] L2 約 2 秒後自動顯示
- [ ] L3 需要點擊展開
- [ ] L4 在 L3 展開後顯示
- [ ] 所有層級的內容正確
- [ ] 中英文切換正常（可在 Stage 4 測試語言切換）

**預期結果**：
- ✅ L1-L4 按順序正確顯示
- ✅ 自動揭示和手動揭示邏輯正確
- ✅ 內容正確顯示

**測試狀態**：□ 通過 □ 失敗

---

## 三、已修復功能驗證測試（重點測試）

### 3.1 i18n 翻譯修復驗證

**測試步驟**：
1. 打開頁面，檢查是否還有原始 key 顯示（如 `symbol_heaven`）
2. 切換語言，檢查所有文字是否正確翻譯
3. 打開 Console，檢查是否有 i18n 相關警告

**測試項目**：
- [ ] 無原始 key 顯示（所有文字都是翻譯後的中文/英文）
- [ ] 所有符碼名稱正確翻譯
- [ ] Console 無 i18n 警告（開發環境可能有警告，屬正常）

**預期結果**：
- ✅ 無原始 key 顯示
- ✅ 所有文字正確翻譯

**測試狀態**：□ 通過 □ 失敗

---

### 3.2 點擊範圍修復驗證

**測試步驟**：
1. 嘗試點擊符碼的文字標籤（不只是圓點）
2. 確認文字也可以選取符碼
3. 測試不同位置的符碼（內圈、中圈、外圈）

**測試項目**：
- [ ] 點擊文字可以選取（**關鍵測試點**）
- [ ] 點擊圓點可以選取
- [ ] 點擊範圍足夠大（不需要精確點擊）

**預期結果**：
- ✅ 文字和圓點都可點擊
- ✅ 點擊範圍足夠大

**測試狀態**：□ 通過 □ 失敗

---

### 3.3 確認按鈕可見性修復驗證

**測試步驟**：
1. 選滿 3 個符碼
2. 檢查確認按鈕是否可見
3. 嘗試捲動頁面，檢查按鈕是否固定在底部（sticky 定位）
4. 檢查按鈕是否在可視區域內

**測試項目**：
- [ ] 確認按鈕可見（不需要捲動就能看到）
- [ ] 按鈕使用 sticky 定位（捲動時固定在底部）
- [ ] 按鈕背景漸變清晰可見

**預期結果**：
- ✅ 按鈕始終可見
- ✅ 使用 sticky 定位

**測試狀態**：□ 通過 □ 失敗

---

### 3.4 文字定位修復驗證

**測試步驟**：
1. 檢查符碼文字是否清晰可讀
2. 檢查文字是否有陰影效果（提高可讀性）
3. 檢查文字位置是否合理（不與圓點重疊）

**測試項目**：
- [ ] 文字清晰可讀
- [ ] 文字有適當的陰影效果
- [ ] 文字位置合理

**預期結果**：
- ✅ 文字清晰可讀
- ✅ 視覺效果良好

**測試狀態**：□ 通過 □ 失敗

---

## 四、可選驗收測試（Gate #5 和 Gate #6）

### 4.1 Gate #5：風險覆蓋測試（可選）

**測試前提**：需要修改測試數據

**測試步驟**：
1. 備份 `ui/public/data/compiled_facet.json`
2. 修改 JSON 文件，將 `risk_level` 從 `"NORMAL"` 改為 `"HIGH"`
3. 重新載入頁面
4. 完成 Stage 2 和 Stage 3，進入 Stage 4
5. 檢查 L4 是否顯示安全模板（而不是動態建議）

**測試項目**：
- [ ] 高風險時 L4 顯示安全模板
- [ ] 動態建議被忽略
- [ ] 安全模板內容正確

**預期結果**：
- ✅ 高風險時正確顯示安全模板

**測試狀態**：□ 通過 □ 失敗 □ 未測試

**注意**：此測試需要修改數據文件，屬於可選測試。

---

### 4.2 Gate #6：視覺解耦測試（可選）

**測試前提**：需要修改測試數據

**測試步驟**：
1. 備份 `ui/public/data/compiled_facet.json`
2. 修改 JSON 文件中的 `theme_config`（例如修改顏色）
3. 重新載入頁面
4. 檢查視覺元素是否變化

**測試項目**：
- [ ] 主題配置修改後視覺元素變化
- [ ] 主題引擎正常工作

**預期結果**：
- ✅ 主題切換正常

**測試狀態**：□ 通過 □ 失敗 □ 未測試

**注意**：此測試需要修改數據文件，屬於可選測試。

---

## 五、完整流程測試

### 5.1 完整用戶流程

**測試步驟**：
1. 打開 http://localhost:5173/
2. 等待頁面載入完成
3. 在 Stage 2 選取 3 個符碼
4. 點擊確認按鈕
5. 在 Stage 3 選擇一個選項
6. 觀察 Stage 4 的 L1-L4 層級揭示
7. 測試語言切換（在任一階段）

**測試項目**：
- [ ] 完整流程順暢
- [ ] 無錯誤或中斷
- [ ] 所有階段正常顯示

**測試狀態**：□ 通過 □ 失敗

---

### 5.2 響應式設計測試（可選）

**測試步驟**：
1. 調整瀏覽器視窗大小
2. 檢查不同尺寸下的顯示效果
3. 測試手機模式（Chrome DevTools 設備模擬）

**測試項目**：
- [ ] 桌面端顯示正常
- [ ] 平板端顯示正常
- [ ] 手機端顯示正常

**測試狀態**：□ 通過 □ 失敗 □ 未測試

---

## 六、問題記錄

如果發現問題，請記錄：

1. **問題描述**：
   - 

2. **重現步驟**：
   - 

3. **預期行為**：
   - 

4. **實際行為**：
   - 

5. **截圖**（如有）：
   - 

6. **Console 錯誤**（如有）：
   - 

---

## 七、測試檢查清單總結

### 必須測試項目

- [ ] Gate #1：資料串接
- [ ] Gate #2：CN/EN 即時切換
- [ ] Gate #3：儀式介面（Stage 2）
  - [ ] 視覺檢查
  - [ ] 互動功能（重點：點擊範圍、確認按鈕可見性）
  - [ ] 流程跳轉
- [ ] Gate #4：結果呈現（Stage 4）
  - [ ] L1-L4 層級呈現
- [ ] 已修復功能驗證
  - [ ] i18n 翻譯修復
  - [ ] 點擊範圍修復
  - [ ] 確認按鈕可見性修復
  - [ ] 文字定位修復
- [ ] 完整流程測試

### 可選測試項目

- [ ] Gate #5：風險覆蓋（需要修改數據）
- [ ] Gate #6：視覺解耦（需要修改數據）
- [ ] 響應式設計測試

---

## 八、測試完成後

### 8.1 記錄測試結果

請在以下位置記錄測試結果：
- `P0-5/P0-5_MANUAL_TEST_RESULT.md`（如果存在）
- 或直接回報測試結果

### 8.2 測試通過標準

**核心功能測試**：
- ✅ 所有必須測試項目通過
- ✅ 無阻斷性錯誤
- ✅ 所有已修復功能正常

**完整驗收測試**：
- ✅ 所有必須測試項目通過
- ✅ Gate #5 和 Gate #6 測試通過（可選）

---

**測試指南版本**：v1.0  
**最後更新**：2026-01-11
