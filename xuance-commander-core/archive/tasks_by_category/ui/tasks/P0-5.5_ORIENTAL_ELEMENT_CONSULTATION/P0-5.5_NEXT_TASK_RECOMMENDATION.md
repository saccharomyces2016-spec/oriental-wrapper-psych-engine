# P0-5.5 完成後的下一個任務建議

**建立日期**：2026-01-11  
**依據**：P0-5.5 決策文件、整體進度、終極目標

---

## 一、當前狀態

### 1.1 已完成任務

- ✅ **P0-5**：建立最小 UI 串接（已完成）
- ✅ **P0-5.5**：東方玄學元素選擇決策（剛完成）
  - 最終決策：易經矩陣系統（I Ching Matrix System）
  - 決策文件：FINAL / CANON LOCKED

### 1.2 當前階段

**Phase 0：MVP（單一構面）**

根據 ROADMAP：
- [x] P0-1 至 P0-5 已完成
- [x] P0-5.5 已完成（東方玄學元素選擇）
- [ ] P0-6 最小付費/權限策略（占位，不優化）

---

## 二、P0-5.5 決策的影響

### 2.1 立即執行項目（來自決策文件第8節）

根據 `P0-5.5_ELEMENT_SELECTION_DECISION.md`，決策文件中明確列出「立即執行項目」：

#### 8.1 UMIP 演進至 v1.1（資料結構）
- `UserProfile` 新增：`dob: string | null`、`root_element: enum | null`
- `ResultPayload` 新增：`hexagram_id: string | number`、`changing_line_index: number | null`、`root_flow_collision_key: string`

#### 8.2 核心演算法（最小可行）
- DOB → Root Element（干支/映射器）：允許缺值
- Stage 1–3 → Hexagram + Changing Line（推導器）
- Root × Flow → Collision Narrative Key（模板索引）

#### 8.3 Facet 內容錨定（從既有 facet 開始）
- `income_expansion_pressure` 需建立「Facet ↔ 卦象路徑」對照

### 2.2 系統架構變更需求

新的系統架構要求：
- **三層架構**：結構層（八卦/六十四卦）、動態層（五行生剋）、運算層（雙軌制）
- **雙軌運算機制**：Track A（先天本命）、Track B（後天流年）
- **Stage 1-4 映射變更**：
  - Stage 1：先天八卦盤（需實作）
  - Stage 2：五行羅盤（需調整現有 Radial Compass）
  - Stage 3：鑄爻（需調整現有 Projection）
  - Stage 4：卦象顯影（需調整現有 Results）

---

## 三、任務選項分析

### 選項 A：實作 P0-5.5 決策的立即執行項目（推薦）

**任務名稱**：P0-5.6 易經矩陣系統基礎實作（I Ching Matrix System Implementation）

**任務性質**：系統架構實作任務

**優先級**：P0（立即處理，阻斷主線）

**理由分析**：

1. **決策文件明確要求**：
   - P0-5.5 決策文件中明確列出「立即執行項目」
   - 所有後續 UI、敘事、演算法必須以新 Canon 為唯一依歸

2. **阻塞後續開發**：
   - 如果不實作新系統，後續的 Stage 1-4 調整無法進行
   - 無法進行用戶驗證（因為 UI 需要符合新系統）

3. **技術依賴順序**：
   - 必須先建立資料結構（UMIP v1.1）
   - 然後實作核心演算法
   - 最後調整 UI/UX

**目標**：
1. UMIP 演進至 v1.1（資料結構調整）
2. 核心演算法實作（最小可行版本）
3. Facet 內容錨定（建立卦象對照表）

**交付物**：
1. `schemas/umip_schema_v1.1.json`（資料結構定義）
2. 核心演算法模組（DOB → Root Element、Stage 1-3 → Hexagram）
3. Facet ↔ 卦象對照表
4. 技術實作報告

**預計時間**：2-3 週

**依賴關係**：
- 依賴：P0-5.5（已完成）
- 阻塞：後續 Stage 1-4 UI 調整、P1-1 用戶驗證

---

### 選項 B：跳過實作，直接進行 P1-1 用戶驗證（不推薦）

**任務名稱**：P1-1 使用者驗證計劃

**任務性質**：用戶驗證任務

**優先級**：P0（但需要前置條件）

**理由分析**：

**不推薦的原因**：
1. **系統不匹配**：
   - 當前 UI 不符合新選定的易經矩陣系統
   - 用戶驗證的結果無法反映新系統的真實效果

2. **技術債務**：
   - 如果先進行用戶驗證，之後需要重新調整 UI 以符合新系統
   - 會造成重複工作和資源浪費

3. **決策文件要求**：
   - 決策文件明確要求「所有後續 UI、敘事、演算法必須以本 Canon 為唯一依歸」
   - 違反這個要求會被視為缺陷（Defect）

**建議**：等 P0-5.6 完成後再進行 P1-1

---

### 選項 C：進行 P0-6 最小付費/權限策略（不推薦）

**任務名稱**：P0-6 最小付費/權限策略

**任務性質**：功能擴展任務

**優先級**：P2（占位，不優化）

**理由分析**：

**不推薦的原因**：
1. **ROADMAP 明確標記**：
   - P0-6 標記為「占位，不優化」
   - 不是當前優先任務

2. **不阻塞主線**：
   - 不影響核心功能開發
   - 可以在後續階段處理

---

## 四、推薦的下一個任務

### 推薦任務：P0-5.6 易經矩陣系統基礎實作

**推薦理由**：

1. **決策文件明確要求**：
   - P0-5.5 決策文件第8節明確列出「立即執行項目」
   - 這是決策的延續，必須執行

2. **阻塞後續開發**：
   - 所有後續任務（Stage 1-4 調整、用戶驗證）都依賴新系統的實作
   - 不實作會造成開發阻塞

3. **技術邏輯順序**：
   - 先建立基礎架構（資料結構、演算法）
   - 然後調整 UI/UX
   - 最後進行用戶驗證
   - 這是合理的開發順序

4. **對齊終極目標**：
   - 實作新系統是實現「後端科學極大化，前端玄學極致化」的必要步驟
   - 直接影響「真的可以幫到人」的目標

---

## 五、任務實施建議

### 5.1 任務分解

**階段 1：資料結構調整（1 週）**
- UMIP Schema v1.0 → v1.1
- 新增 `UserProfile` 欄位（`dob`、`root_element`）
- 新增 `ResultPayload` 欄位（`hexagram_id`、`changing_line_index`、`root_flow_collision_key`）

**階段 2：核心演算法實作（1 週）**
- DOB → Root Element 映射器
- Stage 1-3 → Hexagram + Changing Line 推導器
- Root × Flow → Collision Narrative Key 生成器

**階段 3：Facet 內容錨定（0.5-1 週）**
- 建立 `income_expansion_pressure` ↔ 卦象對照表
- 建立測試用例

### 5.2 技術實施要點

1. **容錯處理**：
   - DOB 為選填項，必須處理缺值情況
   - 必須以 Stage 1-3 的行為資料推導「後天優勢屬性」作為替代 Root

2. **資料結構向後兼容**：
   - UMIP v1.1 必須向後兼容 v1.0
   - 現有 Facet JSON 應該仍然可用

3. **測試要求**：
   - 必須建立測試用例驗證核心演算法
   - 必須驗證 Facet ↔ 卦象對照的正確性

---

## 六、後續任務預覽

完成 P0-5.6 後，建議的後續任務順序：

1. **P0-5.7：Stage 1-4 UI 調整**
   - 調整 Stage 1：實作先天八卦盤
   - 調整 Stage 2：調整 Radial Compass 為五行羅盤
   - 調整 Stage 3：調整 Projection 為鑄爻
   - 調整 Stage 4：調整 Results 為卦象顯影

2. **P1-1：使用者驗證計劃**
   - 在符合新系統的 UI 基礎上進行用戶驗證
   - 驗證「真的準、真的有幫助」

---

## 七、風險評估

### 7.1 技術風險

- **演算法複雜度**：易經矩陣系統的演算法可能需要較長時間實作
- **向後兼容性**：需要確保現有資料結構仍然可用

### 7.2 時間風險

- **預計時間**：2-3 週可能較緊，需要密切監控進度
- **建議**：可以分階段交付，先完成最小可行版本

---

## 八、總結

### 8.1 推薦任務

**任務名稱**：P0-5.6 易經矩陣系統基礎實作

**優先級**：P0（立即處理，阻斷主線）

**預計時間**：2-3 週

### 8.2 執行建議

- **立即開始**：P0-5.6 易經矩陣系統基礎實作
- **分階段交付**：先完成最小可行版本，再逐步完善
- **密切監控**：需要確保進度符合預期

---

**文件版本**：v1.0  
**最後更新**：2026-01-11
