# P0-5.6 易經矩陣系統實作 - 工程師簡報文件

**文件版本**：v1.0  
**建立日期**：2026-01-11  
**任務編號**：P0-5.6  
**任務名稱**：易經矩陣系統實作（I Ching Matrix System Implementation）

---

## ⚠️ 重要：請先閱讀任務包

**必讀文件**：`P0-5.6_TASK_PACKET.md`

本文件是工程師簡報文件，提供詳細的背景資料和技術要求。但請先閱讀任務包以了解任務概述和交付物要求。

---

## 一、項目終極目標

### 1.1 三個核心要求

根據項目 CHARTER，我們的終極目標必須**同時滿足**：

1. **真的能賺錢**（Profitability）
2. **真的可以上國際**（Internationalization, CN/EN 原生敘事）
3. **真的可以幫到人**（User Value：使用者覺得準、看得懂、有幫助）

### 1.2 核心策略

**「後端科學極大化，前端玄學極致化」**

這是系統的核心架構原則，**必須嚴格遵守**。

---

## 二、系統核心架構（必須理解）

### 2.1 二元架構原則（核心約束）

我們的系統採用「二元架構」：

#### 後端（不可見層）：
- 使用現代心理學與相關科學系統作為核心引擎
- 結構化的數據處理（問卷、評分、風險鏈）
- 可推導的計算邏輯
- **使用者完全看不到這個層級**

#### 前端（可見層）：
- 使用者只感知到「完整的玄學系統」
- 使用五行、八卦等東方玄學元素作為表層呈現
- **關鍵**：五行、八卦只能在表層，不能污染現代科學的計算結果

### 2.2 雙重計算原則（關鍵機制）

**⚠️ 核心機制：雙重計算，結果一致**

**關鍵理解**：
- **玄學系統（五行、八卦）也會經過完整的計算**
- **玄學計算結果必須與科學計算結果一致**
- **最終呈現給使用者的是科學計算的正確結果，但以經過確實計算的玄學結果的模樣呈現**

#### 雙重計算流程：

1. **科學計算路徑**（內部驗證基準）：
   - 使用者回答題目
   - 系統使用現代科學方法計算（心理學評估、風險分析等）
   - 得到科學計算結果（分數、風險等級、建議等）
   - 這個結果作為「驗證基準」

2. **玄學計算路徑**（表層呈現系統）：
   - 使用者回答題目（與科學計算路徑相同）
   - 系統使用玄學系統計算（五行、八卦、易經邏輯等）
   - 得到玄學計算結果（卦象、五行屬性、玄學建議等）
   - **玄學系統有完整的計算邏輯，不是簡單的「映射」或「包裝」**

3. **結果驗證與一致性檢查**（內部處理）：
   - 兩種計算結果必須一致
   - 科學計算結果作為驗證基準
   - 如果玄學計算結果與科學計算結果不一致，需要調整玄學計算邏輯或參數
   - **一致性優先**：如果出現不一致，優先以科學計算結果為準

4. **表層呈現**（使用者看到）：
   - 呈現給使用者的是：**玄學計算結果的模樣**
   - 但這個結果已經過驗證，與科學計算結果一致
   - 使用者只看到玄學系統，但結果是正確的（因為與科學計算一致）
   - 使用者**不知道**背後有科學計算和雙重驗證

#### 關鍵原則：

1. **玄學系統不是裝飾，而是真正的計算系統**
   - 五行、八卦有完整的計算邏輯
   - 需要建立完整的玄學計算引擎

2. **雙重驗證機制**
   - 科學計算和玄學計算必須同時進行
   - 兩種結果必須一致
   - 科學計算作為「驗證基準」

3. **一致性優先**
   - 如果出現不一致，優先以科學計算結果為準
   - 需要調整玄學計算邏輯或參數，使其與科學計算結果一致
   - 不能為了「看起來像玄學」而犧牲結果的正確性

#### 禁止事項（嚴格禁止）：
- ❌ 不得讓玄學計算結果影響科學計算結果
- ❌ 不得為了「看起來像玄學」而犧牲結果的正確性
- ❌ 不得向使用者暴露科學計算過程
- ❌ 不得向使用者說明「其實這是科學計算」
- ❌ 不得在科學計算階段使用玄學邏輯（科學計算必須保持純科學）

#### 允許事項：
- ✅ 玄學系統有完整的計算邏輯
- ✅ 科學計算和玄學計算同時進行
- ✅ 兩種計算結果必須一致
- ✅ 呈現給使用者的是玄學計算結果（但已驗證與科學計算一致）
- ✅ 內部保留雙重計算機制和驗證邏輯（供審計與維護，但使用者看不到）

### 2.3 用戶認知目標

**在使用者的認知與體驗中，這是一個完整的玄學系統。**

使用者只會、也只需要感知到：
- 這是一個玄學網站
- 這是一套命理／神秘系統
- 這個系統非常準
- 這個系統對自己很有幫助

使用者**不需要、也不應該**被告知：
- 任何心理學名詞
- 任何現代科學背景
- 任何「其實這不是玄學」的說明

---

## 三、系統架構詳解（P0-5.5 決策）

### 3.1 系統 Canon：易經矩陣系統

我們已經確定採用：**易經矩陣系統（I Ching Matrix System）**

#### 系統定義：

> 一套以「八卦／六十四卦」作為狀態空間（Structure / State Space），  
> 以「五行生剋」作為動態解釋層（Dynamics / Interpretation），  
> 以「雙軌輸入（本命 × 流年）」驅動運算與敘事輸出（Dual-Track Engine）  
> 的動態神諭系統（Data-Driven Oracle）。

### 3.2 三層架構

#### 3.2.1 結構層（The Skeleton）：八卦 / 六十四卦

**角色**：
- 狀態空間（State Space）
- 人生構面座標（Facet Space）
- 最終局勢符號（Hexagram）

**輸出**：`hexagram_id`（0-63 或 1-64，共 64 個卦象）

**在實作中的應用**：
- Stage 1 使用八卦（8 個卦象）作為分流選擇
- Stage 4 使用六十四卦（64 個卦象）作為最終結果呈現

**技術要求**：
- 需要建立 64 個卦象的資料結構
- 需要建立卦象 ID 與卦名的對照表
- 需要支持 CN/EN 雙語的卦名

#### 3.2.2 動態層（The Blood）：五行生剋

**角色**：
- 衝突與修復的解釋邏輯（Why / How it changes）
- 用於解釋「為什麼會這樣」「如何改變」

**輸出**：`interaction_tags`（例如：generate / control / drain 等內部標籤）

**五行系統**：
- 五個元素：金（METAL）、木（WOOD）、水（WATER）、火（FIRE）、土（EARTH）
- 相生關係：木→火→土→金→水→木
- 相剋關係：木→土→水→火→金→木

**在實作中的應用**：
- Stage 2 使用五行（5 個元素）作為符碼選擇
- 用於解釋結果中的動態關係
- 用於計算 Root Element

**技術要求**：
- 需要建立五行元素的資料結構
- 需要建立五行生剋關係的對照表
- 需要實作五行相生相剋的計算邏輯

#### 3.2.3 運算層（The Engine）：雙軌制（Root × Flow）

**Track A：先天本命（Root / Nature）**
- **輸入**：DOB（出生年月日）- **選填**
- **計算**：DOB → Root Element（五行）
- **容錯**：若缺 DOB，使用 Stage 1-3 的行為資料推導「後天優勢屬性」
- **用途**：身份錨點、敘事個性化
- **決策權**：僅用於個性化，不得取代 Flow 的決策權

**Track B：後天流年（Flow / Nurture）**
- **輸入**：Stage 1-3 的互動選擇與問卷量表
- **計算**：Stage 1-3 → Hexagram + Changing Line
- **決策權**：最終建議、風險鏈、行動方案的決策權以 Flow 為準

**Collision（碰撞運算）**：
- **核心形式**：`Result = f(Root, Flow)`
- **用途**：解釋「為何你是這樣的人（Root）」在「此刻遭遇這種局勢（Flow）」時會出現此壓力與風險走向

**技術要求**：
- 需要實作 DOB → Root Element 映射器
- 需要實作 Stage 1-3 → Hexagram + Changing Line 推導器
- 需要實作 Root × Flow → Collision Narrative Key 計算器

---

## 四、Stage 1-4 詳細說明

### 4.1 Stage 1：八卦定方位（The Wheel）

**UI 隱喻**：先天八卦盤（Primordial Bagua）

**功能**：分流選擇（Facet Space 定位）

**八卦系統**：
- 八個卦象：乾（QIAN）、坤（KUN）、震（ZHEN）、巽（XUN）、坎（KAN）、離（LI）、艮（GEN）、兌（DUI）
- 每個卦象對應一個領域（例如：事業、感情、健康等）
- 必須包含「中宮/混沌」作為兜底入口

**用戶操作**：
- 強制單選（一次只能選擇一個）
- 選擇後進入 Stage 2

**技術要求**：
- 需要建立八卦的資料結構
- 需要建立八卦與 Facet 的對照表
- 需要實作八卦選擇的邏輯

**設計約束**（來自 P0-5.7 設計）：
- 互動方式：Rotate（旋轉）→ Snap（吸附）→ Lock（鎖定）
- 選中卦象發出金光，其餘沒入陰影

### 4.2 Stage 2：五行定物象（Radial Compass）

**UI 隱喻**：五行羅盤（Elemental Compass）

**功能**：符碼選擇（顯性特徵 / 投射物）

**五行系統**：
- 五個元素：金、木、水、火、土
- 每個元素對應一類特徵/物象

**用戶操作**：
- 多選（選擇 2-3 個）
- 選擇後進入 Stage 3

**技術要求**：
- 需要建立五行的資料結構
- 需要建立五行與符碼的對照表
- 需要實作五行選擇的邏輯

**設計約束**（來自 P0-5.7 設計）：
- 互動方式：Beam（光束指針）→ Select（多選）
- 文字如活字印刷般凸起，選中元素間產生生剋連結線

### 4.3 Stage 3：爻變定歸因（Projection）

**UI 隱喻**：鑄爻（Casting Lines）

**功能**：量表權重 → 變爻觸發 → 卦象轉移

**易經系統**：
- 每個卦象由六個爻組成
- 每個爻可以是「陽爻」（—）或「陰爻」（--）
- 變爻：某些爻會改變（陽變陰，或陰變陽）
- 變爻後形成新的卦象

**用戶操作**：
- 回答問題（單選或多選）
- 問題回答後觸發「變爻」
- 變爻後形成最終卦象

**技術要求**：
- 需要建立爻的資料結構
- 需要建立變爻觸發的邏輯
- 需要實作卦象轉移的計算

**設計約束**（來自 P0-5.7 設計）：
- 互動方式：Charge（蓄力）→ Release（釋放）→ Result（顯爻）
- 蓄力動畫 `min_duration` 需設為 800ms+，以等待後端 API 計算結果
- 銅錢落地正反面由後端決定，強制渲染為對應的陰/陽爻

### 4.4 Stage 4：卦象顯影（Results）

**UI 隱喻**：卦象顯影（Hexagram Visualization）

**功能**：結果呈現（L1-L4 分層）

**L1-L4 分層結構**：

**L1：Hexagram 視覺顯影**
- 呈現最終卦象（六十四卦之一）
- 立即顯示

**L2：Root 個性化錨點**
- 呈現先天本命（Root Element）
- 即使缺 DOB 也必須存在（使用推導的後天優勢屬性）
- 約 2 秒後自動顯示

**L3：Flow 局勢分析**
- 呈現後天流年分析（卦辭現代化）
- 用戶觸發顯示（點擊展開）

**L4：風險阻斷與行動建議**
- 呈現風險鏈和行動建議
- 在 L3 展開後顯示

**技術要求**：
- 需要建立卦象視覺化的資料結構
- 需要建立 L1-L4 分層呈現的邏輯
- 需要實作 Root 和 Flow 的碰撞結果呈現

**設計約束**（來自 P0-5.7 設計）：
- 互動方式：Unroll（展開）→ Development（顯影）
- 左側 Root 與右側 Flow 墨跡交匯，暈染出最終建議

---

## 五、立即執行項目詳解

### 5.1 UMIP 演進至 v1.1（資料結構）

#### 5.1.1 UserProfile 新增欄位

**當前狀態**：UMIP v1.0 未定義 UserProfile

**需要新增**：
```typescript
interface UserProfile {
  dob: string | null;           // 出生年月日（ISO 8601 格式，例如：1985-03-15）
  root_element: RootElement | null;  // 先天本命五行屬性
}

enum RootElement {
  METAL = "METAL",    // 金
  WOOD = "WOOD",      // 木
  WATER = "WATER",    // 水
  FIRE = "FIRE",      // 火
  EARTH = "EARTH"     // 土
}
```

**欄位說明**：
- `dob`（Date of Birth）：出生年月日
  - 類型：`string | null`
  - 格式：ISO 8601（例如：`1985-03-15`）
  - 說明：選填，若未提供則使用 Stage 1-3 的行為資料推導「後天優勢屬性」
- `root_element`（Root Element）：先天本命五行屬性
  - 類型：`RootElement | null`
  - 說明：由 DOB 計算得出，或由 Stage 1-3 推導得出

#### 5.1.2 ResultPayload 新增欄位

**當前狀態**：UMIP v1.0 未定義 ResultPayload（結果載荷）

**需要新增**：
```typescript
interface ResultPayload {
  hexagram_id: number;                // 最終卦象 ID（0-63 或 1-64）
  changing_line_index: number | null; // 變爻索引（0-5 或 null）
  root_flow_collision_key: string;    // 碰撞運算結果鍵
}
```

**欄位說明**：
- `hexagram_id`（Hexagram ID）：最終卦象 ID
  - 類型：`number`
  - 範圍：0-63 或 1-64（實作時統一）
  - 說明：由 Stage 1-3 推導得出
- `changing_line_index`（Changing Line Index）：變爻索引
  - 類型：`number | null`
  - 範圍：0-5（對應六個爻的位置），若無變爻則為 `null`
  - 說明：由 Stage 3 的問題回答觸發
- `root_flow_collision_key`（Root-Flow Collision Key）：碰撞運算結果鍵
  - 類型：`string`
  - 說明：用於索引碰撞敘事模板（例如：`"wood_gold_conflict"`）

#### 5.1.3 Schema 文件位置

- **當前 Schema**：`schemas/umip_schema_v1.json`
- **新 Schema**：`schemas/umip_schema_v1.1.json`
- **注意**：需要保持向後兼容（UMIP v1.0 的資料仍可正常處理）

### 5.2 核心演算法（最小可行）

#### 5.2.1 DOB → Root Element（干支/映射器）

**功能**：將出生年月日轉換為五行屬性

**輸入**：
- `dob: string | null`（ISO 8601 格式，例如：`1985-03-15`）

**輸出**：
- `root_element: "METAL" | "WOOD" | "WATER" | "FIRE" | "EARTH" | null`

**演算法要求**：
- 使用傳統干支系統（天干地支）計算
- 可參考標準的干支轉換演算法
- 需要支援西曆年份（例如：1985 = 乙丑年）
- 天干對應五行：
  - 甲、乙 → 木（WOOD）
  - 丙、丁 → 火（FIRE）
  - 戊、己 → 土（EARTH）
  - 庚、辛 → 金（METAL）
  - 壬、癸 → 水（WATER）

**容錯規範（強制）**：
- 若 `dob` 為 `null` 或無效，返回 `null`（由 Stage 1-3 推導器處理）
- 若日期解析失敗，返回 `null`

**實作位置**：
- 建議建立新文件：`engine/root_element_mapper.py` 或類似

**測試要求**：
- 測試有效 DOB（例如：1985-03-15 → WOOD）
- 測試無效 DOB（例如：`null` → `null`）
- 測試邊界情況（例如：1900-01-01、2100-12-31）

#### 5.2.2 Stage 1–3 → Hexagram + Changing Line（推導器）

**功能**：根據使用者的 Stage 1-3 互動選擇，推導出最終卦象和變爻

**輸入**：
- Stage 1 選擇：八卦選擇（例如：`"KUN"` 坤卦）
- Stage 2 選擇：五行選擇（例如：`["WOOD", "FIRE"]`）
- Stage 3 選擇：問題回答（例如：`{q1: "option_a", q2: "option_b"}`）

**輸出**：
- `hexagram_id: number`（0-63 或 1-64）
- `changing_line_index: number | null`（0-5 或 null）

**演算法要求**：
- 需要建立「Stage 1-3 輸入 → 卦象」的映射邏輯
- 需要考慮五行生剋關係
- 需要考慮變爻的觸發條件（例如：特定問題回答組合）
- 需要確保結果與科學計算結果一致（見雙重計算原則）

**實作位置**：
- 建議建立新文件：`engine/hexagram_deriver.py` 或類似

**測試要求**：
- 測試不同 Stage 1-3 組合
- 測試變爻觸發條件
- 測試與科學計算結果的一致性

#### 5.2.3 Root × Flow → Collision Narrative Key（模板索引）

**功能**：根據 Root 和 Flow 的組合，生成碰撞敘事鍵

**輸入**：
- `root_element: "METAL" | "WOOD" | "WATER" | "FIRE" | "EARTH" | null`
- `hexagram_id: number`
- `changing_line_index: number | null`

**輸出**：
- `root_flow_collision_key: string`（例如：`"wood_gold_conflict"`）

**演算法要求**：
- 需要建立「Root × Hexagram → Collision Key」的映射表
- 需要考慮五行生剋關係（例如：木被金克 = `"wood_gold_conflict"`）
- 需要考慮卦象屬性（例如：困卦 = 困境）
- Collision Key 用於索引最終的敘事模板

**實作位置**：
- 建議建立新文件：`engine/collision_calculator.py` 或類似

**測試要求**：
- 測試不同 Root × Flow 組合
- 測試五行生剋關係的計算
- 測試 Collision Key 的正確性

### 5.3 Facet 內容錨定（從既有 facet 開始）

**目標**：建立 `income_expansion_pressure` Facet 與卦象路徑的對照表

#### 5.3.1 對照表結構

**需要建立**：「Facet ↔ 卦象路徑」對照表

**對照關係**：
- Facet 的科學計算結果（Score、Risk Level、Band）→ 對應的卦象（Hexagram ID）
- Facet 的特定問題回答組合 → 對應的變爻（Changing Line Index）

**注意事項**：
- 卦名（如「困」「渙」）可作為敘事素材，但**工程上必須以 `hexagram_id`/key 驅動**
- 避免語言造成耦合與翻譯漂移
- 需要建立可回溯的模板鍵（Traceable Template Keys）

#### 5.3.2 實作要求

**文件位置**：
- 建議建立：`domain/facets/income_expansion_pressure.hexagram_mapping.v1.0.json`

**文件結構**（建議）：
```json
{
  "facetId": "income_expansion_pressure",
  "domainVersion": "1.0",
  "hexagram_mapping": {
    "bands": {
      "low": {
        "hexagram_candidates": [1, 2, 11],
        "default_hexagram_id": 11,
        "rationale": "低風險對應平穩、順利的卦象"
      },
      "mid": {
        "hexagram_candidates": [47, 48],
        "default_hexagram_id": 47,
        "rationale": "中風險對應困境、需要調整的卦象"
      },
      "high": {
        "hexagram_candidates": [47, 29],
        "default_hexagram_id": 47,
        "rationale": "高風險對應困境、危險的卦象"
      }
    },
    "changing_line_triggers": {
      "q1_option_a_q2_option_b": {
        "changing_line_index": 2,
        "rationale": "特定問題回答組合觸發第 2 爻變"
      }
    }
  }
}
```

**驗證要求**：
- 需要確保對照表與科學計算結果一致
- 需要建立測試用例驗證映射正確性

---

## 六、雙重計算機制實作詳解

### 6.1 雙重計算流程實作

#### 6.1.1 科學計算路徑（內部驗證基準）

**當前狀態**：已實作（`engine/score_facet.py`）

**功能**：
- 使用現代科學方法計算（心理學評估、風險分析等）
- 產出：`Risk_Level`, `Score`, `Scientific_Advice`

**實作要求**：
- 保持現有實作不變
- 科學計算結果作為驗證基準，不得被玄學計算影響

#### 6.1.2 玄學計算路徑（表層呈現系統）

**當前狀態**：未實作（本任務需要實作）

**功能**：
- 使用五行生剋與易經卦理進行推演
- 產出：`Hexagram_ID`, `Element_Tags`, `Metaphysical_Text`

**實作要求**：
- 需要實作完整的玄學計算引擎
- 需要實作 DOB → Root Element 映射器
- 需要實作 Stage 1-3 → Hexagram + Changing Line 推導器
- 需要實作 Root × Flow → Collision Narrative Key 計算器

#### 6.1.3 結果驗證與一致性檢查（內部處理）

**當前狀態**：未實作（本任務需要實作）

**功能**：
- 比較兩種計算結果
- 確保玄學計算結果與科學計算結果一致
- 如果不一致，調整玄學計算邏輯或參數

**實作要求**：
- 需要建立一致性檢查機制
- 需要建立調整機制（當不一致時，調整玄學計算參數）
- 需要建立驗證測試

**一致性檢查邏輯**（來自 P0-5.7 設計）：
1. **計算**：科學引擎算出 `Risk: HIGH`
2. **篩選**：玄學引擎從 64 卦中，篩選出所有帶有「凶/悔/吝」屬性的卦象作為 `Candidate_Set`
3. **匹配**：玄學引擎根據使用者的 Stage 1-3 輸入（五行/方位），從 `Candidate_Set` 中挑選最符合的卦象
4. **鎖定**：將此結果（卦象 ID、變爻、風險等級）打包，作為不可變更的 Payload

> **⚠️ 嚴格約束**：若玄學計算結果與科學結果衝突，**必須**調整玄學參數或重選卦象，**絕不可**修改科學評估結果。

#### 6.1.4 表層呈現（使用者看到）

**當前狀態**：部分實作（Stage 4 結果呈現已實作）

**功能**：
- 呈現給使用者的是：**玄學計算結果的模樣**
- 但這個結果已經過驗證，與科學計算結果一致

**實作要求**：
- 需要整合玄學計算結果到 Stage 4 結果呈現
- 需要確保使用者只看到玄學系統，不看到科學計算過程

---

## 七、技術實作約束

### 7.1 程式語言與框架

**當前技術棧**：
- 後端：Python（`engine/score_facet.py`）
- 前端：TypeScript + React（`ui/` 目錄）
- Schema：JSON Schema

**實作要求**：
- 核心演算法建議使用 Python（與現有後端保持一致）
- 如果需要前端實作，使用 TypeScript + React
- Schema 使用 JSON Schema

### 7.2 測試要求

**測試框架**：
- Python：建議使用 `pytest`
- TypeScript：建議使用 `jest` 或 `vitest`

**測試覆蓋率要求**：
- 單元測試覆蓋率 ≥ 80%
- 整合測試覆蓋所有主要流程
- Golden Tests 通過

**測試用例要求**：
- 正常情況測試
- 邊界情況測試
- 異常情況測試
- 一致性驗證測試

### 7.3 代碼品質要求

**編碼規範**：
- Python：遵循 PEP 8
- TypeScript：遵循專案現有的 ESLint 規則

**文檔要求**：
- 所有公開函數都需要文檔字符串
- 複雜邏輯需要註釋說明
- 演算法需要技術文檔說明

### 7.4 性能要求

**演算法性能**：
- DOB → Root Element 映射：< 10ms
- Stage 1-3 → Hexagram 推導：< 50ms
- Collision 計算：< 20ms

**系統穩定性**：
- 無記憶體洩漏
- 無死鎖風險
- 錯誤處理完善

---

## 八、AI 敘事生成層規範（P0-5.7 設計要求）

### 8.1 角色定位

**AI 是敘事者 (Narrator)，不是運算者 (Calculator)。**

AI 僅負責將本機引擎計算出的結構化數據，轉譯為具備文學性、同理心與玄學氛圍的自然語言報告。

### 8.2 資料流向

1. **本機運算 (Local Calc)**：雙引擎完成計算，鎖定 `Risk_Level`, `Hexagram_ID`, `Changing_Line`, `Action_Points`
2. **Payload 建構**：系統將上述鎖定結果封裝為 JSON Context
3. **AI 生成 (Generation)**：將 JSON Context 傳送至 AI 模型（LLM），依據 Prompt 生成完整報告
4. **使用者呈現 (Presentation)**：前端顯示 AI 生成的文本

### 8.3 嚴格約束

為了確保正確性與可審計性，AI 轉化版必須嚴格遵守以下規則：

1. **禁止 AI 重新解卦**：AI 不得自行根據卦象 ID 進行網路搜索或自由聯想，必須依據 Payload 中提供的 `Interpretation_Key` 進行擴寫
2. **禁止 AI 修改風險**：若本機判定為 HIGH Risk，AI 生成的語氣必須是警示性的，不得生成「其實沒關係」的安撫話語
3. **禁止 AI 新增建議**：AI 僅能潤飾本機提供的 `Action_Points`，不得無中生有

**實作要求**：
- 需要建立 Payload 建構機制
- 需要建立 AI 生成接口（可選，本任務可不實作，但需要定義接口）
- 需要建立驗證機制（確保 AI 輸出符合規則）

---

## 九、相關文件索引

### 9.1 核心決策文件

- **P0-5.5 決策文件**：`P0-5.5_ORIENTAL_ELEMENT_CONSULTATION/P0-5.5_ELEMENT_SELECTION_DECISION.md`
  - 系統架構定義
  - Stage 1-4 映射
  - 雙軌運算機制
  - 立即執行項目（本任務的依據）

- **P0-5.7 設計文檔**：`P0-5.7_WORLDVIEW_DESIGN/P0-5.7_DESIGN_DOC_FINAL.md`
  - 世界觀設計規格
  - Stage 1-4 互動方式定義
  - AI 敘事生成層規範

- **P0-5 UMIP 設計**：`P0-5/P0-5_UMIP_CLOSURE_REPORT.md`
  - UMIP 架構原則
  - 視覺解耦機制
  - Stage 1-4 規格

### 9.2 背景資料文件

- **CHARTER**：`charter/CHARTER.md`
  - 終極目標
  - 核心原則

- **進度分析報告**：`PROGRESS_ANALYSIS_2026-01-11.md`
  - 整體進度分析
  - 任務完成度分析
  - 下一步任務建議

### 9.3 技術文件

- **UMIP Schema v1.0**：`schemas/umip_schema_v1.json`
- **Domain Schema**：`schemas/domain_manifest.schema.json`
- **Compiled Facet Schema**：`schemas/compiled_facet.schema.json`
- **現有評分引擎**：`engine/score_facet.py`

### 9.4 當前任務文件

- **任務包**：`P0-5.6_ICHING_MATRIX_IMPLEMENTATION/P0-5.6_TASK_PACKET.md`
- **工程師簡報文件**：`P0-5.6_ICHING_MATRIX_IMPLEMENTATION/P0-5.6_ENGINEER_BRIEF.md`（本文件）

---

## 十、聯繫與溝通

### 10.1 溝通原則

- **開放討論**：歡迎提出問題、質疑和建議
- **文檔記錄**：所有討論和決策都應記錄在案
- **迭代優化**：可以根據實際情況調整實作方向

### 10.2 時間安排

- **預計時間**：2-3 週
- **分解**：
  - UMIP v1.1 Schema：1-2 天
  - 核心演算法實作：1-2 週
  - Facet 內容錨定：2-3 天
  - 測試與驗證：3-5 天

---

**文件狀態**：READY FOR IMPLEMENTATION  
**下一步**：開始易經矩陣系統實作工作

---

**文件版本**：v1.0  
**最後更新**：2026-01-11
