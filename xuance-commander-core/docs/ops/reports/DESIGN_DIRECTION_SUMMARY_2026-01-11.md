# 網頁設計方向與細節摘要

**建立日期**：2026-01-11  
**狀態**：CURRENT DESIGN DIRECTION  
**目的**：簡要說明目前確立的網頁設計方向和細節

---

## 一、系統架構核心

### 1.1 二元架構原則

**核心策略**：「後端科學極大化，前端玄學極致化」

- **後端（不可見層）**：
  - 使用現代心理學與相關科學系統作為核心引擎
  - 結構化的數據處理（問卷、評分、風險鏈）
  - 可推導的計算邏輯
  - **使用者完全看不到這個層級**

- **前端（可見層）**：
  - 使用者只感知到「完整的玄學系統」
  - 使用易經、五行等東方玄學元素作為表層呈現
  - **關鍵**：玄學元素只能在表層，不能污染現代科學的計算結果

### 1.2 雙重計算機制

**核心機制**：雙重計算，結果一致

- **科學計算路徑**（內部驗證基準）：
  - 使用者回答題目
  - 系統使用現代科學方法計算（心理學評估、風險分析等）
  - 得到科學計算結果（分數、風險等級、建議等）
  - 這個結果作為「驗證基準」

- **玄學計算路徑**（表層呈現系統）：
  - 使用者回答題目（與科學計算路徑相同）
  - 系統使用玄學系統計算（五行、八卦、易經邏輯等）
  - 得到玄學計算結果（卦象、五行屬性、玄學建議等）
  - **玄學系統有完整的計算邏輯，不是簡單的「映射」或「包裝」**

- **結果驗證與一致性檢查**（內部處理）：
  - 兩種計算結果必須一致
  - 科學計算結果作為驗證基準
  - 如果出現不一致，優先以科學計算結果為準

- **表層呈現**（使用者看到）：
  - 呈現給使用者的是：**玄學計算結果的模樣**
  - 但這個結果已經過驗證，與科學計算結果一致
  - 使用者只看到玄學系統，但結果是正確的（因為與科學計算一致）

---

## 二、玄學系統：易經矩陣系統

### 2.1 系統定義

**系統 Canon**：易經矩陣系統（I Ching Matrix System）

> 一套以「八卦／六十四卦」作為狀態空間（Structure / State Space），  
> 以「五行生剋」作為動態解釋層（Dynamics / Interpretation），  
> 以「雙軌輸入（本命 × 流年）」驅動運算與敘事輸出（Dual-Track Engine）  
> 的動態神諭系統（Data-Driven Oracle）。

### 2.2 三層架構

#### 2.2.1 結構層（The Skeleton）：八卦 / 六十四卦

- **角色**：狀態空間、人生構面座標、最終局勢符號
- **輸出**：`hexagram_id`（0-63，共 64 個卦象）
- **應用**：
  - Stage 1：八卦（8 個卦象）作為分流選擇
  - Stage 4：六十四卦（64 個卦象）作為最終結果呈現

#### 2.2.2 動態層（The Blood）：五行生剋

- **角色**：衝突與修復的解釋邏輯（Why / How it changes）
- **輸出**：`interaction_tags`（例如：generate / control / drain 等內部標籤）
- **五行系統**：
  - 五個元素：金、木、水、火、土
  - 相生關係：木→火→土→金→水→木
  - 相剋關係：木→土→水→火→金→木
- **應用**：
  - Stage 2：五行（5 個元素）作為符碼選擇
  - 用於解釋結果中的動態關係

#### 2.2.3 運算層（The Engine）：雙軌制（Root × Flow）

**Track A：先天本命（Root / Nature）**
- **輸入**：DOB（出生年月日）- **選填**（使用者可以不提供）
- **計算**：DOB → Root Element（五行之一）
- **容錯**：若缺 DOB，使用 Stage 1-3 的行為資料推導「後天優勢屬性」
- **用途**：身份錨點、敘事個性化
- **決策權**：僅用於個性化，不得取代 Flow 的決策權

**Track B：後天流年（Flow / Nurture）**
- **輸入**：Stage 1-3 的互動選擇與問卷量表
- **計算**：Stage 1-3 → Hexagram + Changing Line
- **決策權**：最終建議、風險鏈、行動方案的決策權以 Flow 為準

**Collision（碰撞運算）**
- **核心形式**：`Result = f(Root, Flow)`
- **用途**：解釋「為何你是這樣的人（Root）」在「此刻遭遇這種局勢（Flow）」時會出現此壓力與風險走向

---

## 三、4 階段全像漏斗（Stage 1-4）

### 3.1 Stage 1 — The Wheel（八卦定方位 / Facet Triage）

- **UI 隱喻**：先天八卦盤（Primordial Bagua）
- **功能**：分流選擇（Facet Space 定位）
- **互動方式**：使用者選擇八卦方位
- **輸出**：Stage 1 選擇的八卦方位

### 3.2 Stage 2 — Radial Compass（五行定物象 / Symbol Selection）

- **UI 隱喻**：五行羅盤（Elemental Compass）
- **功能**：符碼選擇（顯性特徵 / 投射物）
- **互動方式**：使用者在五行羅盤上選擇符碼
- **輸出**：Stage 2 選擇的五行元素組合

### 3.3 Stage 3 — Projection（爻變定歸因 / Deep Profiling）

- **UI 隱喻**：鑄爻（Casting Lines）
- **功能**：量表權重 → 變爻觸發 → 卦象轉移
- **互動方式**：使用者回答深度問題（量表）
- **輸出**：Stage 3 的回答數據

### 3.4 Stage 4 — Results（卦象顯影 / Analysis & Action）

- **UI 隱喻**：Hexagram Manifestation（卦象顯影）
- **功能**：結果呈現與建議
- **層級輸出**（固定）：
  - **L1**：Hexagram 視覺顯影（卦象顯示）
  - **L2**：Root 個性化錨點（若缺 DOB 亦必須存在）
  - **L3**：Flow 局勢分析（卦辭現代化）
  - **L4**：風險阻斷與行動建議（對應 risk chain）

---

## 四、計算方式

### 4.1 科學計算路徑

1. **輸入**：使用者回答 Stage 1-3 的問題
2. **計算**：
   - 使用現代心理學評估方法
   - 計算分數和風險等級
   - 生成建議和風險鏈
3. **輸出**：科學計算結果（內部驗證基準）

### 4.2 玄學計算路徑

1. **輸入**：使用者回答 Stage 1-3 的問題（與科學計算路徑相同）

2. **Track A 計算**（Root Element）：
   - 輸入：DOB（選填）
   - 計算：DOB → Root Element（五行）
   - 若缺 DOB：使用 Stage 1-3 行為資料推導「後天優勢屬性」

3. **Track B 計算**（Hexagram）：
   - 輸入：Stage 1-3 的互動選擇
   - 計算：
     - Stage 1（八卦）→ 基礎卦象方向
     - Stage 2（五行）→ 補充資訊
     - Stage 3（量表）→ 變爻觸發
     - 綜合計算 → Hexagram ID（0-63）+ Changing Line（0-5 或 null）

4. **Collision 計算**：
   - 輸入：Root Element + Hexagram
   - 計算：`Collision Key = f(Root, Flow)`
   - 用途：生成個性化敘事和建議

5. **一致性驗證**：
   - 玄學計算結果必須與科學計算結果一致
   - 科學計算結果作為驗證基準
   - 如果出現不一致，優先以科學計算結果為準

6. **輸出**：玄學計算結果（經過驗證，與科學計算一致）

### 4.3 結果呈現

- **呈現給使用者**：玄學計算結果的模樣
- **但結果已驗證**：與科學計算結果一致
- **使用者感知**：完整的玄學系統，結果正確且有幫助

---

## 五、視覺設計風格

### 5.1 基本視覺風格

- **色彩**：米紙白、墨黑、硃砂紅、銅金、翡翠綠、靛藍
- **字體**：宋/明體（儀式感）+ 無襯線（功能性）
- **材質**：邊框、印章、墨跡效果
- **語境**：「儀式即計算」、「計算的墨水」

### 5.2 互動設計原則

- **「去問卷化」原則**：避免傳統問卷元素（滑桿、李克特量表）
- **「儀式化互動」**：單一物件選擇、旋轉、擲幣等儀式感互動
- **動畫與過場**：增強儀式感和神秘感

---

## 六、國際化與多語言

### 6.1 雙語支援

- **語言**：中文（繁體，zh-TW）和英文（en-US）
- **原則**：
  - 中文版本像原生中文玄學系統
  - 英文版本像原生英文玄學產品
  - 不得像翻譯，必須是原生語感

### 6.2 即時切換

- **技術**：CN/EN 即時切換，無需重新載入頁面
- **資料來源**：從 compiled facet JSON 的 `i18n` 欄位讀取

---

## 七、AI 敘事生成層

### 7.1 AI 角色定位

- **角色**：AI 是「敘事者」，不是「計算者」
- **功能**：將結構化數據轉換為文學性、同理心、玄學主題的自然語言報告

### 7.2 數據流

1. **本地計算**：系統進行科學和玄學雙重計算
2. **Payload 生成**：將計算結果組織成 Payload
3. **AI 生成**：AI 根據 Payload 生成最終報告
4. **呈現**：將 AI 生成的報告呈現給使用者

### 7.3 嚴格約束

- **不得重新解釋卦象**：AI 不得重新解釋或修改卦象意義
- **不得修改風險等級**：AI 不得修改科學計算的風險等級
- **不得新增建議**：AI 不得添加本地計算未提供的建議
- **遵守語境規則**：AI 必須遵守「純玄學系統」語境，不得使用心理學名詞

---

## 八、使用者認知目標

### 8.1 使用者感知

使用者只會、也只需要感知到：
- 這是一個玄學網站
- 這是一套命理／神秘系統
- 這個系統非常準
- 這個系統對自己很有幫助

### 8.2 使用者不應感知

使用者**不需要、也不應該**被告知：
- 任何心理學名詞
- 任何現代科學背景
- 任何「其實這不是玄學」的說明

---

## 九、技術架構

### 9.1 前端技術棧

- **框架**：React 18 + Vite + TypeScript
- **狀態管理**：Zustand（全域狀態）+ React Context（流程狀態）
- **路由**：React Router
- **國際化**：自建 i18n 系統（從 JSON 讀取）

### 9.2 後端技術棧

- **語言**：Python
- **核心引擎**：
  - `engine/root_element_mapper.py` - DOB → Root Element
  - `engine/hexagram_deriver.py` - Stage 1-3 → Hexagram
  - `engine/collision_calculator.py` - Root × Flow → Collision Key

### 9.3 資料格式

- **協議**：UMIP（Universal Metaphysical Interface Protocol）
- **版本**：v1.1（已擴展 UserProfile 和 ResultPayload）
- **格式**：JSON Schema

---

## 十、當前狀態

### 10.1 已完成

- ✅ 系統架構決策（易經矩陣系統）
- ✅ 基礎演算法實作（P0-5.6）
- ✅ 世界觀設計（P0-5.7）
- ✅ UI 基礎實作（P0-5）
- ✅ 4 階段流程設計

### 10.2 進行中

- 🔄 玄學運算系統資料收集與完善（P0-11）
- 🔄 演算法完善（需要擴充 64 卦完整映射等）

### 10.3 待完成

- ⏳ 結果呈現頁面設計（P0-13）
- ⏳ UI 介面改善（P0-8）
- ⏳ 特效動畫設計與實作（P0-9）
- ⏳ 題庫完善（P0-10）
- ⏳ 科學運算引擎完善（P0-12）
- ⏳ AI 整合設計（P0-14）

---

**文件狀態**：CURRENT DESIGN DIRECTION  
**建立日期**：2026-01-11  
**最後更新**：2026-01-11
