# INFORMATION_CLASSIFICATION_RULE（資訊分類規則）

## 狀態
- ACTIVE（自 2026-01-09 起生效）
- 必須納入副指揮官快照
- 總指揮產出任務包時必須遵守此規則

---

## 目的
根據 GPT 上下文長度限制，明確區分哪些資訊應該放在快照（長期記憶）中，哪些資訊應該放在任務包（單次任務）中，確保副指揮官能夠：
1. 持續性地遵守基本規範（不遺忘）
2. 在單次任務中獲得充足的背景資訊（95%+ 資訊充足性）
3. 在長時間討論中記住關鍵資訊

---

## 核心原則

### 資訊分類標準
- **快照（DEPUTY_COMMANDER_SNAPSHOT.md）**：持續性指導、不能遺忘的資訊
- **任務包**：單次任務判斷和執行所需的資訊（包含項目歷史摘要和背景資料）
- **路徑引用**：快照中通過路徑引用指向詳細記錄，減少快照大小

---

## 快照內容（持續性指導｜不能遺忘）

### 必須放在快照中的資訊

#### 1. 最終目標和不可違反的限制（Must Have）
- **最終目標**：`FULL/NORTH_STAR.md` 的核心內容
- **專案目標**：`charter/CHARTER.md` 的核心內容
- **不可觸碰限制**：硬性規則（不因任務而改變）
- **成功定義**：必須達成的目標（不因任務而改變）

**理由**：
- ✅ 這些是**所有任務都必須遵守**的基礎
- ✅ 副指揮官在任何時候都不能違反這些規則
- ✅ 必須持續存在於上下文中，不能遺忘

#### 2. 角色定位和工作原則（Must Have）
- **副指揮官的職責**：核心職責、權利、限制
- **總指揮的職責**：核心職責、如何與副指揮官互動
- **顧問師角色系統**：所有可用的角色（R1-R5）及其職責
- **工作原則**：文本為主線、任務包優先、專業意見、可追溯性

**理由**：
- ✅ 這些是**工作方式的基礎規範**
- ✅ 副指揮官必須知道自己的角色和責任
- ✅ 必須持續存在於上下文中，確保行為一致

#### 3. 基本制度規範（Must Have）
- **文件寫入位置規則**：基本路徑規範（雖然由總指揮負責，但副指揮官需要知道基本原則）
- **任務包執行規則**：如何執行任務包的基本流程
- **顧問師使用規範**：如何使用顧問師、審核輸出

**理由**：
- ✅ 這些是**所有任務都必須遵守**的制度
- ✅ 副指揮官必須知道基本規範，即使不直接執行
- ✅ 必須持續存在於上下文中，確保決策一致

#### 4. 當前任務摘要（Should Have｜簡要版本）
- **當前任務狀態**：任務名稱、狀態、基本目標（1-2 行摘要）
- **下一步行動**：基本方向（1-2 行摘要）
- **路徑引用**：詳細記錄位置（`docs/ops/TASK_RECORDS_SUMMARY.md`）

**理由**：
- ✅ 讓副指揮官知道**當前在做什麼**
- ✅ 只保留摘要，詳細資訊通過任務包提供
- ✅ 詳細資訊放在任務包中，避免快照過大

---

## 任務包內容（單次任務判斷和執行）

### 應該放在任務包中的資訊

#### 1. 專案歷史摘要（單次任務用）
- **過去執行歷史**：最近 3-5 個任務的摘要
- **關鍵決策點**：為什麼做這個決定、基於什麼背景
- **失敗經驗**：過去遇到的問題、如何解決

**理由**：
- ✅ 這些是**單次任務判斷**所需的背景資訊
- ✅ 不同任務需要的歷史資訊不同
- ✅ 只在使用時提供，不需要持續存在於上下文中

#### 2. 專案整體狀態（單次任務用）
- **整體進度**：當前階段、整體完成度
- **階段性目標**：當前階段的目標、已完成、待完成
- **整體決策脈絡**：為什麼現在要執行這個任務
- **風險與挑戰**：整體項目面臨的風險

**理由**：
- ✅ 這些是**單次任務分析**所需的整體資訊
- ✅ 幫助副指揮官理解任務的整體背景
- ✅ 只在使用時提供，不需要持續存在於上下文中

#### 3. 未來規劃摘要（單次任務用）
- **短期任務清單**：接下來 1-2 週的任務
- **階段性規劃**：當前階段 → 下一個階段 → 目標
- **決策點**：哪些決策點需要特別注意

**理由**：
- ✅ 這些是**單次任務規劃**所需的未來資訊
- ✅ 幫助副指揮官理解任務與整體規劃的關係
- ✅ 只在使用時提供，不需要持續存在於上下文中

#### 4. 當前任務詳細資訊（單次任務用）
- **任務目標**：一句話目標和預期成果
- **背景資料**：相關文件、現狀分析、相關任務
- **任務內容**：具體步驟、交付物、驗收標準
- **約束條件**：硬性限制、參考規範、禁區
- **資源需求**：需要哪些顧問師、文件、工具
- **優先級與時程**：P0/P1/P2/P3、預計時程、依賴關係

**理由**：
- ✅ 這些是**單次任務執行**所需的詳細資訊
- ✅ 每個任務的詳細資訊不同
- ✅ 只在使用時提供，執行完後不需要持續存在於上下文中

---

## 資訊分類決策樹

### 判斷流程

```
1. 這個資訊是否所有任務都必須遵守？
   ├─ 是 → 放在快照（持續性指導）
   └─ 否 → 繼續判斷

2. 這個資訊是否會因任務而改變？
   ├─ 是 → 放在任務包（單次任務用）
   └─ 否 → 繼續判斷

3. 這個資訊是否需要在長時間討論中一直記得？
   ├─ 是 → 放在快照（通過路徑引用指向詳細記錄）
   └─ 否 → 放在任務包（單次任務用）

4. 這個資訊是否很大（超過 100 行）？
   ├─ 是 → 放在任務包，快照中只保留路徑引用
   └─ 否 → 可以放在快照
```

---

## 具體分類列表

### ✅ 快照內容（DEPUTY_COMMANDER_SNAPSHOT.md）

#### Must Have（必須包含）
1. **最終目標**：
   - 系統最終目標（`FULL/NORTH_STAR.md` 核心內容）
   - 專案目標（`charter/CHARTER.md` 核心內容）
   - 不可觸碰限制（硬性規則）
   - 成功定義（必須達成）

2. **角色定位**：
   - 副指揮官職責和權利
   - 總指揮職責和權利
   - 顧問師角色系統（R1-R5 完整定義）

3. **工作原則**：
   - 文本為主線
   - 任務包優先
   - 專業意見
   - 可追溯性

4. **基本制度規範**（摘要）：
   - 文件寫入位置規則（摘要）
   - 任務包執行規則（摘要）
   - 顧問師使用規範（摘要）

#### Should Have（應該包含）
5. **當前任務摘要**（簡要版本）：
   - 當前任務名稱、狀態（1-2 行）
   - 基本目標（1-2 行）
   - 下一步行動（1-2 行）
   - 路徑引用：`docs/ops/TASK_RECORDS_SUMMARY.md`

---

### ✅ 任務包內容（單次任務使用）

#### 專案歷史摘要（必須包含）
1. **過去執行歷史**：
   - 最近 3-5 個任務摘要
   - 關鍵決策點
   - 失敗經驗（如果有）
   - 詳細記錄路徑引用

2. **專案整體狀態**：
   - 整體進度
   - 階段性目標
   - 整體決策脈絡
   - 風險與挑戰

3. **未來規劃摘要**：
   - 短期任務清單
   - 階段性規劃
   - 決策點

#### 當前任務詳細資訊（必須包含）
4. **任務目標**：
   - 一句話目標
   - 預期成果

5. **背景資料**：
   - 相關文件（路徑和內容摘要）
   - 現狀分析（當前狀態、已完成、待完成、阻塞點）
   - 相關任務（上游、下游、並行）

6. **任務內容**：
   - 具體步驟
   - 交付物清單
   - 驗收標準

7. **約束條件**：
   - 硬性限制
   - 參考規範
   - 禁區

8. **資源需求**：
   - 需要哪些顧問師
   - 需要哪些文件
   - 需要哪些工具

9. **優先級與時程**：
   - 優先級（P0/P1/P2/P3）
   - 預計時程
   - 依賴關係

---

## 快照與任務包的配合策略

### 快照中的路徑引用（Pointer Strategy）

快照中對於**詳細記錄**應該使用路徑引用，而不是完整內容：

```markdown
## 當前任務摘要

### P0-4 Facet Portability & Stress Test（當前任務）
- **狀態**：OPEN（骨架已創建，等待顧問產出）
- **基本目標**：驗證 P0-3 的「引擎 × 玄學外皮」是否能在第二個 Facet 上「零改動搬移」且不崩壞
- **下一步**：R2 定義主隱喻 + R4 擴充禁用詞
- **詳細記錄**：見 `docs/ops/TASK_RECORDS_SUMMARY.md`（P0-4 詳細摘要）
```

### 任務包中的完整資訊

任務包中應該包含執行任務所需的**完整資訊**：

```markdown
## 專案歷史摘要

### 過去執行歷史
- **最近完成的任務**：
  - P0-3（✅ READY_FOR_FREEZE）：[完整摘要]
  - P0-2（✅ COMPLETED）：[完整摘要]
- **關鍵決策點**：[完整說明]
- **詳細記錄**：`docs/ops/TASK_RECORDS_INDEX.md`

### 專案整體狀態
- **整體進度**：[完整說明]
- **階段性目標**：[完整說明]
- **整體決策脈絡**：[完整說明]
- **風險與挑戰**：[完整說明]

### 未來規劃摘要
- **短期任務清單**：[完整清單]
- **階段性規劃**：[完整規劃]
- **決策點**：[完整說明]
```

---

## 資訊更新策略

### 快照更新時機
1. **最終目標變更**：立即更新（很少發生）
2. **角色定位變更**：立即更新（很少發生）
3. **基本制度變更**：立即更新（摘要版本）
4. **當前任務狀態變更**：定期更新（摘要版本）

### 任務包更新時機
1. **每次產出任務包時**：必須包含最新的專案歷史摘要和當前任務詳細資訊
2. **任務狀態變更時**：立即更新任務包中的任務狀態資訊
3. **新任務開始時**：產出包含完整專案歷史摘要的新任務包

---

## 資訊充足性檢查清單

### 總指揮（Cursor）產出任務包時

#### ✅ 快照內容檢查
- [ ] 最終目標是否在快照中？（必須）
- [ ] 角色定位是否在快照中？（必須）
- [ ] 工作原則是否在快照中？（必須）
- [ ] 基本制度規範是否在快照中？（必須，摘要版本）
- [ ] 當前任務摘要是否在快照中？（應該，簡要版本）

#### ✅ 任務包內容檢查
- [ ] 專案歷史摘要是否在任務包中？（必須）
  - [ ] 過去執行歷史（最近 3-5 個任務）
  - [ ] 專案整體狀態
  - [ ] 未來規劃摘要
- [ ] 當前任務詳細資訊是否在任務包中？（必須）
  - [ ] 任務目標
  - [ ] 背景資料
  - [ ] 任務內容
  - [ ] 約束條件
  - [ ] 資源需求
  - [ ] 優先級與時程

---

## 資訊分類範例

### 範例 1：最終目標
- **分類**：快照（持續性指導）
- **理由**：所有任務都必須遵守，不能遺忘
- **內容**：完整內容（核心部分，不超過 50 行）

### 範例 2：P0-3 任務的詳細成果
- **分類**：任務包（單次任務用）
- **理由**：只在相關任務（如 P0-4）中需要，不需要持續存在於上下文中
- **內容**：完整摘要（在任務包中）

### 範例 3：當前任務的下一步行動
- **分類**：快照（簡要版本）+ 任務包（詳細版本）
- **理由**：
  - 快照中保留簡要版本（1-2 行），讓副指揮官知道當前方向
  - 任務包中包含詳細版本，包含所有執行所需的資訊
- **內容**：
  - 快照：1-2 行摘要 + 路徑引用
  - 任務包：完整詳細資訊

### 範例 4：顧問師角色系統（R1-R5）
- **分類**：快照（持續性指導）
- **理由**：副指揮官在任何時候都需要知道可以調用哪些顧問師
- **內容**：完整定義（所有角色的職責、輸入、輸出、禁區、驗收標準）

### 範例 5：P0-4 任務的詳細背景資料
- **分類**：任務包（單次任務用）
- **理由**：只在執行 P0-4 相關任務時需要，不需要持續存在於上下文中
- **內容**：完整詳細資訊（在任務包中）

---

## 資訊大小控制

### 快照大小控制（目標：≤ 2000 行）
- **最終目標**：≤ 50 行（核心內容）
- **角色定位**：≤ 100 行（完整定義）
- **工作原則**：≤ 50 行（核心原則）
- **基本制度規範**：≤ 100 行（摘要版本）
- **當前任務摘要**：≤ 50 行（簡要版本）
- **總計**：≤ 350 行（核心部分）
- **其他**：顧問師角色系統（R1-R5）：≤ 500 行（完整定義）
- **總計目標**：≤ 1000 行（核心快照）

### 任務包大小控制（目標：≤ 1000 行）
- **專案歷史摘要**：≤ 300 行
  - 過去執行歷史：≤ 150 行
  - 專案整體狀態：≤ 100 行
  - 未來規劃摘要：≤ 50 行
- **當前任務詳細資訊**：≤ 700 行
  - 任務目標：≤ 20 行
  - 背景資料：≤ 200 行
  - 任務內容：≤ 200 行
  - 約束條件：≤ 100 行
  - 資源需求：≤ 50 行
  - 優先級與時程：≤ 50 行
  - 驗收標準：≤ 80 行

---

## 路徑引用策略

### 快照中的路徑引用
對於**詳細記錄**，快照中應該使用路徑引用：

```markdown
## 當前任務摘要

### P0-4 Facet Portability & Stress Test（當前任務）
- **狀態**：OPEN
- **基本目標**：驗證 P0-3 的「引擎 × 玄學外皮」是否能在第二個 Facet 上「零改動搬移」且不崩壞
- **下一步**：R2 定義主隱喻 + R4 擴充禁用詞
- **詳細記錄**：
  - `docs/ops/TASK_RECORDS_SUMMARY.md`（P0-4 詳細摘要）
  - `xuance-commander-core/P0-4/P0-4_CHARTER.md`（P0-4 Charter）
```

### 任務包中的路徑引用
任務包中可以引用**相關文件**，但必須包含**內容摘要**：

```markdown
## 背景資料

### 相關文件
- **P0-3 Charter**：`P0-3/P0-3_CHARTER.md`
  - **內容摘要**：P0-3 的結構定義、目標、Non-goals
- **P0-4 Facet Brief**：`P0-4/P0-4_FACET_BRIEF.md`
  - **內容摘要**：P0-4 的 Facet 定義、What it is、What it is NOT
```

---

## 狀態
- ACTIVE（自 2026-01-09 起生效）
- 必須納入副指揮官快照
- 總指揮產出任務包時必須遵守此規則
- 快照生成腳本必須參考此規則



