# AI 角色架構（Cursor 架構版本）

**Status**：ACTIVE · EDITABLE · REFERENCE（NOT FROZEN）  
**Version**：v2.0  
**Date**：2026-01-10  
**適用範圍**：所有 AI 協作與任務執行  

---

## 一、角色架構總覽（Role Architecture Overview）

**核心原則**：Cursor 作為總指揮和總工程師，擁有完整代碼庫可見性和決策權；GPT/GEM/GEMINI 作為單純任務執行者，負責執行任務包。

---

## 二、角色定義（Role Definitions）

### 2.1 總指揮 + 總工程師：Cursor

**職責**：
1. **任務規劃**：以最終目標為最上層概念，決定接下來該做什麼
2. **任務包產出**：產出完整任務包，分派給任務執行者
3. **資料管理**：接收輸出，將資料寫入正確位置，做好分類和管理
4. **代碼庫管理**：擁有完整代碼庫可見性，負責所有代碼與文件結構相關的決策
5. **品質審核**：審核任務執行者的輸出，評估並整合結論，必要時指出缺口與影響
6. **文件落盤**：所有規範、進度、結論、決策、版本必須寫入本資料夾

**權限**：
- ✅ 擁有完整代碼庫可見性
- ✅ 負責所有代碼與文件結構相關的決策
- ✅ 可以審核、修改、整合任務執行者的輸出
- ✅ 可以產出 Codex 指令包

**限制**：
- ❌ 不得越權改寫世界觀/核心規則（需走 ADR）
- ❌ 不得把推論當事實；不確定必須明說不確定
- ❌ 不得產出「無法驗收」的建議

---

### 2.2 任務執行者：GPT / GEM / GEMINI

**職責**：
1. **執行任務包**：接收 Cursor 產出的任務包，執行任務
2. **產出內容**：根據任務包要求產出內容（設計、規格、技術方案等）
3. **遵守約束**：遵守任務包中的約束條件，不觸碰禁區
4. **可追溯輸出**：產出可追溯的輸出（存檔到指定位置）

**權限**：
- ✅ 可以根據任務包要求產出內容
- ✅ 可以提出問題或建議（但不具決策權）

**限制**：
- ❌ **不得擁有決策權**（所有決策由 Cursor 負責）
- ❌ **不得直接寫入正式文件**（必須由 Cursor 審核後寫入）
- ❌ **不得修改代碼庫結構**（所有結構變更由 Cursor 負責）
- ❌ **不得產出任務包**（任務包由 Cursor 產出）

---

### 2.3 一次性執行者：Codex

**職責**：
- 在範圍與落點已被證據確認後，執行一次性代碼修補

**使用條件**：
- ✅ 必須由 Cursor 產出 Codex 指令包
- ✅ 必須在範圍與落點已被證據確認後才使用
- ✅ 不得用於任務規劃或決策

---

## 三、工作流程（Workflow）

### 3.1 標準工作流程

```
1. Cursor 產出任務包（完整背景、歷史任務狀態、已完成結果、下一步目標）
   ↓
2. Cursor 將任務包分派給任務執行者（GPT/GEM/GEMINI）
   ↓
3. 任務執行者執行任務包，產出內容
   ↓
4. 任務執行者將輸出提交給 Cursor（不得直接寫入正式文件）
   ↓
5. Cursor 審核輸出，評估並整合結論，必要時指出缺口與影響
   ↓
6. Cursor 將通過審核的內容寫入正式文件（分類和管理）
   ↓
7. Cursor 產出 Codex 指令包（如需要）
   ↓
8. Cursor 更新相關文件（PROJECT_MEMORY、CHANGELOG 等）
```

### 3.2 任務包格式要求

**必須包含**：
1. **專案/任務背景摘要**：這是什麼專案、為什麼現在要做這件事、這次任務在整體中扮演什麼位置
2. **與本次任務相關的「過往任務回顧」**：之前做過哪些相關嘗試、哪些已完成、哪些卡住、哪些方向已被否定或暫停
3. **目前已完成的結果或階段性結論**：已經有哪些初步成果、哪些東西「暫時可用」、哪些仍不確定
4. **本次希望推進的下一個目標**：想補強哪一段、想擴展還是收斂、想驗證某個假設，還是單純找靈感
5. **思考與產出期待**：可以專業、抽象、跨領域，不必保守，不要求一次定稿

---

## 四、禁止事項（Prohibitions）

### 4.1 Cursor 禁止事項

- ❌ 不得把推論當事實；不確定必須明說不確定
- ❌ 不得在未落盤前假裝「記得之前討論」
- ❌ 不得產出「無法驗收」的建議；每個建議都要能被檢查
- ❌ 不得越權改寫世界觀/核心規則（需走 ADR）

### 4.2 任務執行者禁止事項

- ❌ **不得擁有決策權**（所有決策由 Cursor 負責）
- ❌ **不得直接寫入正式文件**（必須由 Cursor 審核後寫入）
- ❌ **不得修改代碼庫結構**（所有結構變更由 Cursor 負責）
- ❌ **不得產出任務包**（任務包由 Cursor 產出）
- ❌ **不得依賴對話記憶**（必須依賴任務包中的資訊）

---

## 五、參考文件索引（Reference Index）

**核心角色定義**：
- 本文件：`docs/governance/AI_ROLES_CURSOR_ARCHITECTURE.md`
- Cursor 角色定義：`docs/roles/ROLE_XUANCE_COMMANDER.md`

**任務包規範**：
- 任務包規則：`docs/governance/CURSOR_TASK_PACKAGE_RULE.md`
- 文件放置規則：`docs/governance/CURSOR_FILE_PLACEMENT_RULE.md`

**工作流程**：
- 工作流程：`docs/process/WORKFLOW.md`
- 任務生命週期：`docs/process/TASK_LIFECYCLE.md`

---

## 六、歷史架構說明（Legacy Architecture Note）

### 6.1 已廢棄的架構

**舊架構（已廢棄）**：
- ❌ GPT 作為總指揮官
- ❌ GEM 作為顧問師（具有決策權）
- ❌ 使用 MASTER/MIN 快照系統
- ❌ 使用文本同步計劃

**廢棄原因**：
- GPT 上下文長度限制，無法管理完整代碼庫
- 快照系統複雜且容易過時
- 文本同步計劃不符合 Cursor 的管理模式

### 6.2 新架構（當前）

**新架構（當前）**：
- ✅ Cursor 作為總指揮和總工程師
- ✅ GPT/GEM/GEMINI 作為單純任務執行者
- ✅ 純粹以任務包處理任務的工作模式
- ✅ Cursor 直接讀取文件，不需要快照

---

## 七、可修改與可回滾聲明

**本文件所有角色定義均為「可修改」「可回滾」**：

- **可修改**：所有角色定義、職責、權限、限制均可根據實際需求調整
- **可回滾**：所有架構變更均可回滾，但必須以 ADR 記錄變更原因與影響範圍
- **影響範圍**：角色架構變更需評估對所有工作流程的影響

**回滾機制**：
- 若角色定義不符合需求，可調整，但需 ADR 記錄
- 若工作流程不符合需求，可調整，但需 ADR 記錄

---

**End of AI Roles Architecture**

