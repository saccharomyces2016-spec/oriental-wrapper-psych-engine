# AI Collaboration Architecture（AI 協作架構｜治理層級文件）

## 狀態
- ACTIVE
- EDITABLE
- 日期：2026-01-09

---

## 架構角色反轉提案（重要更新）

**日期**：2026-01-09  
**提案者**：使用者（基於實際運作經驗）

### 提案核心
考慮讓 **Cursor 兼任總指揮 + 總工程師**，GPT 轉為「審核顧問」，Gemini 保持顧問師角色。

### 詳細分析與建議
見 `docs/governance/proposals/ARCHITECTURE_ROLE_REVERSAL_PROPOSAL.md`

### 總工程師（Cursor）的初步評估
✅ **認同提案方向**，但建議採用**漸進式調整**（方案 B），以降低風險並充分利用各 AI 的優勢。

---

## 核心認知（總工程師理解確認）

### 對您的理解的正確性確認

您對各 AI 角色的理解 **基本正確**，以下為確認與補充：

#### ✅ Cursor（總工程師）的能力與限制
- ✅ **完整代碼庫可見性**：可以看到整個資料夾結構和所有文件
- ✅ **互相比對與察覺衝突**：可以直接讀取文件、檢查結構、驗證規則
- ✅ **理解文件目的**：知道文件為了什麼而生、為了什麼而作
- ✅ **功能強大**：在模型等級沒有因流量刪減的情況下，功能不輸 GPT
- ⚠️ **流量限制**：使用第三方軟體（Cursor）+ OpenAI API，流量相對較少
- ✅ **更適合執行而非規劃**：由於流量限制，更適合執行具體任務，而非長時間的規劃討論

**補充說明**：
- Cursor 的上下文窗口較長（可處理大型文件），但**不能假設會永久記住所有規範**
- 規範仍必須寫在文本中，Cursor 通過讀取文件檢查，而非依賴記憶
- 流量限制確實存在，但在**同一個對話中**可以持續參考之前的內容

#### ✅ 程序端 GPT（總指揮）的能力與限制
- ✅ **無法看到完整代碼庫**：最多只能通過快照看到部分內容
- ✅ **沒有永久記憶**：每次開啟快照都是「從零開始」
- ✅ **依賴快照**：只能看到單一快照內容，無法直接讀取文件
- ✅ **流量較多**：適合做長時間的規劃討論工作
- ✅ **更適合規劃與決策**：由於流量優勢，更適合承擔規劃、討論、決策的工作

**補充說明**：
- 程序端 GPT 的上下文窗口較短（≤ 4000 tokens），必須控制快照大小
- MIN 快照已瘦身至 1569 行，但仍可能接近上限
- 必須通過路徑引用查看詳細內容，不能直接讀取文件

#### ✅ Gemini（GEM 模式）的定位
- ✅ **顧問角色系統**：用於創建顧問角色（R1/R2/R4 等）
- ✅ **建議稿產出**：顧問輸出僅為建議稿，不得直接寫入正式 domain
- ✅ **必須審核**：所有顧問輸出必須經過指揮官審核後才能寫入

**補充說明**：
- Gemini 的輸出必須存檔到 `docs/gem/runs/`，可追溯
- 指揮官負責審核顧問輸出，決定是否採納、拒絕或修改

#### ⚠️ Codex 的現況
- ✅ **後期比較幫不上忙**：您對 Codex 的理解正確
- ⚠️ **仍保留基本定位**：一次性代碼修補執行者（在範圍與落點已被證據確認後才使用）

---

## 現有制度評估

### ✅ 已建立的制度（運作良好）

#### 1. 混合控管模式（已實施）
- ✅ **文本規範作為基礎**：基本規範寫在 MIN 快照中，程序端 GPT 必須遵守
- ✅ **Cursor 主動檢查**：Cursor 負責主動檢查、問題發現、規範維護
- ✅ **分工明確**：基本規範寫在快照中，詳細規範保留在專門文件

#### 2. 接口規範（已實施）
- ✅ **CURSOR_COMMANDER_INTERFACE_RULE.md**：定義 Cursor 與總指揮 GPT 的對口規則
- ✅ **CURSOR_PROACTIVE_SUGGESTION_RULE.md**：允許 Cursor 主動提出建議
- ✅ **CURSOR_COMMANDER_ALERTS.md**：記錄 Cursor 發現的需要總指揮 GPT 關注的事項

#### 3. 快照瘦身（已實施）
- ✅ **MIN 快照從 3102 行降至 1569 行**（減少 49%）
- ✅ **CURRENT_SUMMARY.md**：創建摘要版本（≤ 100 行），替代完整的 CURRENT.md

---

## 制度改善建議

### 建議 1：明確「決策權」與「執行權」的分工

#### 現狀
- 程序端 GPT（總指揮）：負責規劃、討論、決策
- Cursor（總工程師）：負責執行、檢查、驗證

#### 建議改進
**明確決策權層級**：
- **P0 決策（立即執行）**：程序端 GPT 可直接決策，Cursor 執行
- **P1 決策（建議處理）**：程序端 GPT 決策，Cursor 可提出建議，最終由程序端 GPT 裁決
- **P2 決策（可選處理）**：Cursor 可自主決策（不違反基本規範的情況下）

**明確執行權層級**：
- **文件寫入**：Cursor 擁有最終執行權，但必須遵守基本規範
- **規範修改**：必須經過程序端 GPT 決策（通過治理決策流程）
- **錯誤修正**：Cursor 可自主執行（Bug Fix）

#### 建議寫入制度
在 `CURSOR_COMMANDER_INTERFACE_RULE.md` 中補充：
- 明確決策權與執行權的分工
- 明確在哪些情況下 Cursor 可以自主決策
- 明確在哪些情況下必須等待程序端 GPT 決策

---

### 建議 2：建立「流量感知」的工作分配機制

#### 現狀
- Cursor：流量限制，更適合執行
- 程序端 GPT：流量較多，更適合規劃討論

#### 建議改進
**建立「任務類型 → 分配對象」對應表**：

| 任務類型 | 優先分配給 | 理由 |
|---------|----------|------|
| **長時間規劃討論** | 程序端 GPT | 流量優勢，可進行多輪對話 |
| **具體執行任務** | Cursor | 可以看到完整文件，執行效率高 |
| **文件結構檢查** | Cursor | 可以看到完整代碼庫，檢查效率高 |
| **內容創作** | Gemini（GEM 模式） | 顧問角色系統，專業輸出 |
| **規範驗證** | Cursor | 可以直接讀取文件驗證 |
| **決策裁決** | 程序端 GPT | 需要綜合判斷和規劃 |

**建立「流量節約」原則**：
- **Cursor 應避免**：長時間的規劃討論、多輪對話式的探索
- **Cursor 應優先**：執行具體任務、檢查文件結構、驗證規範遵守
- **程序端 GPT 應避免**：需要讀取大量文件的任務、需要比對多個文件的任務
- **程序端 GPT 應優先**：規劃討論、決策裁決、內容創作（通過顧問系統）

#### 建議寫入制度
創建新文件：`docs/governance/TASK_ALLOCATION_RULE.md`
- 定義任務類型與分配對象的對應關係
- 定義流量節約原則
- 定義在流量不足時如何調整工作分配

---

### 建議 3：優化「提醒事項」機制的效率

#### 現狀
- Cursor 發現問題後寫入 `CURSOR_COMMANDER_ALERTS.md`
- 程序端 GPT 通過 MIN 快照查看提醒事項

#### 建議改進
**建立「即時提醒」與「累積提醒」的區分**：
- **即時提醒（P0）**：需要在 MIN 快照中明確標記，程序端 GPT 必須優先處理
- **累積提醒（P1/P2）**：可以累積在提醒事項中，程序端 GPT 可根據優先級處理

**建立「提醒事項」的清理機制**：
- RESOLVED 狀態建議保留 7 天後清理
- REJECTED/DEFERRED 狀態建議保留 30 天後清理
- 確保 MIN 快照不會無限增長

#### 建議寫入制度
在 `CURSOR_PROACTIVE_SUGGESTION_RULE.md` 中補充：
- 明確即時提醒與累積提醒的區分
- 明確提醒事項的清理機制
- 明確程序端 GPT 如何處理不同優先級的提醒

---

### 建議 4：建立「Gemini 顧問系統」的使用規範優化

#### 現狀
- Gemini（GEM 模式）用於創建顧問角色（R1/R2/R4 等）
- 顧問輸出必須經過指揮官審核後才能寫入

#### 建議改進
**明確 Gemini 的使用場景**：
- **適合使用 Gemini**：
  - 內容創作（題目設計、敘事文案、行動建議）
  - 專業領域的建議（需要專業知識的輸出）
  - CN/EN 原生語感校對
- **不適合使用 Gemini**：
  - 文件結構檢查（應由 Cursor 執行）
  - 規範驗證（應由 Cursor 執行）
  - 技術實施（應由 Cursor 執行）

**優化「顧問輸出 → 指揮官審核 → 總工程師執行」的流程**：
- **Step 1**：程序端 GPT 產出「題目卷」（Authoritative Question Set）
- **Step 2**：總工程師封包成 brief（不改寫、不簡化）
- **Step 3**：使用者轉交給 Gemini（顧問）
- **Step 4**：Gemini 產出建議稿
- **Step 5**：程序端 GPT 審核並決策
- **Step 6**：總工程師執行（寫入文本）

#### 建議寫入制度
在 `AI_ADVISORY_ROLES.md` 中補充：
- 明確 Gemini 的使用場景與不適合場景
- 優化「顧問輸出 → 審核 → 執行」的流程
- 明確各角色的責任邊界

---

### 建議 5：建立「Codex 淡出」的明確規範

#### 現狀
- Codex 後期比較幫不上忙
- 但仍保留基本定位（一次性代碼修補執行者）

#### 建議改進
**明確 Codex 的「淡出」原則**：
- **保留使用場景**：
  - 一次性代碼修補（在範圍與落點已被證據確認後才使用）
  - 簡單的腳本生成（如果需要）
- **不再使用場景**：
  - 文件結構檢查（應由 Cursor 執行）
  - 規範驗證（應由 Cursor 執行）
  - 複雜的文件操作（應由 Cursor 執行）

**建立「Codex 替代方案」**：
- 所有原本由 Codex 執行的任務，改由 Cursor 執行
- 確保所有任務都有明確的執行者

#### 建議寫入制度
創建新文件：`docs/governance/CODEX_PHASE_OUT_PLAN.md`
- 明確 Codex 的淡出原則
- 建立 Codex 替代方案
- 確保所有任務都有明確的執行者

---

## 整體評估與建議

### ✅ 現有制度的優勢

1. **分工明確**：各 AI 角色的責任和權限已明確定義
2. **接口規範完整**：Cursor 與程序端 GPT 的對口規則已建立
3. **混合控管模式**：文本規範 + Cursor 主動檢查，平衡了規範的可追溯性和檢查的效率
4. **快照瘦身**：MIN 快照已瘦身，控制程序端 GPT 的上下文窗口

### ⚠️ 現有制度的不足

1. **決策權與執行權的分工不夠明確**：需要更明確的決策權層級
2. **流量感知的工作分配機制缺失**：需要建立「任務類型 → 分配對象」對應表
3. **提醒事項機制的效率可優化**：需要建立即時提醒與累積提醒的區分
4. **Gemini 顧問系統的使用規範可優化**：需要更明確的使用場景
5. **Codex 淡出的明確規範缺失**：需要建立 Codex 淡出計劃

### 🎯 優先建議（按重要性排序）

#### 優先級 P0（立即實施）
1. **明確決策權與執行權的分工**：避免權限衝突和重複工作
2. **建立流量感知的工作分配機制**：優化流量使用，提高效率

#### 優先級 P1（建議實施）
3. **優化提醒事項機制的效率**：提高提醒事項的處理效率
4. **優化 Gemini 顧問系統的使用規範**：明確使用場景，避免誤用

#### 優先級 P2（可選實施）
5. **建立 Codex 淡出計劃**：明確 Codex 的淡出原則，確保任務都有執行者

---

## 對達成最終目標的影響

### ✅ 現有制度已支持最終目標

1. **可追溯性**：所有規範和決策都寫在文本中，可以回溯
2. **可維護性**：文件結構清晰，角色分工明確，易於維護
3. **可擴充性**：Facet 限定明確，為未來擴充保留空間
4. **可驗證性**：所有規則都可 CI / grep 化，可自動驗證

### 🎯 改進建議對最終目標的貢獻

1. **提高效率**：明確的分工和流量感知的工作分配，提高整體效率
2. **降低風險**：明確的決策權與執行權分工，降低權限衝突風險
3. **優化協作**：優化的提醒事項機制和顧問系統使用規範，優化協作流程

---

## 總結與建議

### 您的理解完全正確

您對各 AI 角色的能力、限制和定位的理解**完全正確**，現有制度已經很好地體現了這些理解。

### 制度已相當完善，但可進一步優化

現有制度已經**相當完善**，分工明確、接口規範完整、混合控管模式運作良好。建議的改進都是**增量優化**，而非根本性改變。

### 建議行動方案

1. **短期（立即實施）**：
   - 明確決策權與執行權的分工
   - 建立流量感知的工作分配機制

2. **中期（建議實施）**：
   - 優化提醒事項機制的效率
   - 優化 Gemini 顧問系統的使用規範

3. **長期（可選實施）**：
   - 建立 Codex 淡出計劃

### 最終建議

**現有制度「邊做邊改」的方式是正確的**。建議：
- ✅ 繼續保持現有的混合控管模式
- ✅ 逐步實施上述改進建議
- ✅ 根據實際使用情況調整制度
- ✅ 保持制度的可編輯性和可追溯性

---

## 狀態
- ACTIVE
- EDITABLE
- 摘要必須納入 MIN 快照（總工程師的專業判斷和建議）

---

## MIN 快照摘要（必須納入）

### 核心認知確認
- ✅ 您的理解**完全正確**
- ✅ Cursor：完整代碼庫可見性，流量限制，更適合執行
- ✅ 程序端 GPT：只能看到快照，沒有永久記憶，更適合規劃討論
- ✅ Gemini：顧問角色系統，建議稿產出
- ⚠️ Codex：後期比較幫不上忙，可淡出

### 優先建議（按重要性排序）
**P0（立即實施）**：
1. 明確決策權與執行權的分工（避免權限衝突）
2. 建立流量感知的工作分配機制（優化流量使用）

**P1（建議實施）**：
3. 優化提醒事項機制的效率（即時提醒 vs 累積提醒）
4. 優化 Gemini 顧問系統的使用規範（明確使用場景）

**P2（可選實施）**：
5. 建立 Codex 淡出計劃（明確替代方案）

### 最終建議
- ✅ **現有制度「邊做邊改」的方式是正確的**
- ✅ 繼續保持混合控管模式
- ✅ 逐步實施改進建議
- ✅ 根據實際使用情況調整制度

**詳細內容**：見 `docs/governance/AI_COLLABORATION_ARCHITECTURE.md`

---

## 參考文件
- `docs/governance/CURSOR_COMMANDER_INTERFACE_RULE.md`（接口規範）
- `docs/governance/CURSOR_PROACTIVE_SUGGESTION_RULE.md`（主動建議規則）
- `docs/governance/proposals/CURSOR_GPT_COORDINATION_STRATEGY.md`（協調策略）
- `docs/governance/AI_ADVISORY_ROLES.md`（AI 顧問角色系統）

