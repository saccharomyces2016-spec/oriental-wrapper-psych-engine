# TASK_PACKAGE_P0-4.5_QUESTION_FLOW_FUNNEL_SYSTEM（P0-4.5 題目流程與分流系統設計任務包）

**完整任務包**（包含所有必要背景資料）  
**生成時間**：2026-01-10  
**版本**：v1.0  
**批准狀態**：待總指揮批准

---

## 任務資訊
- **Phase**: P0-4.5 Question Flow & Funnel System Design
- **任務性質**: 設計決策任務（非技術實作、非內容創作，但影響後續所有開發）
- **優先級**: P0（立即處理，阻斷主線）
- **預計時程**: 待定（取決於設計複雜度）

---

## 任務目標（一句話）
設計一個能夠「涵蓋全人類、全年齡、全困擾、全困境」的多階段分流選擇系統，確定題型設計策略，為未來的八卦盤界面設計奠定基礎，確保使用者不會覺得「沒有符合我困境的選項」。

---

## 為什麼現在需要這個任務（背景說明）

### 1. 終極目標的絕對要求
**終極目標要求**（見 `FULL/NORTH_STAR.md`）：
- 「能夠適用於全世界、全文化、全人類、全年齡、全性別、全困擾、全問題場景的解析、引導與連鎖互動系統」
- 「讓全世界所有國家、不分年齡、不分性別、不分困擾的人都可以映射和具現他們現在所面臨的困擾」

**現狀問題**：
- 當前只有單一 Facet 的題目設計（`income_expansion_pressure`、`relationship_imbalance`）
- 沒有跨 Facet 的分流機制
- 使用者進入系統後，只能選擇「事業」或「關係」兩個選項
- **使用者可能會覺得「沒有符合我困境的選項」**

**影響**：
- 如果沒有分流系統，無法達成終極目標
- **這是阻斷性問題，不是優化問題**
- 必須在 P0-5 之前解決，否則後續開發可能偏離終極目標

### 2. 題型設計的關鍵影響
**問題核心**：
- 題型選擇（單選、複選、多選、符號選擇）會直接影響題目的設計方法論
- 題型選擇會影響 UI 架構的設計
- 如果 P0-5 使用錯誤的題型，後續引入八卦盤時可能需要重寫

**現狀問題**：
- P0-5 的題型選擇尚未明確
- 雖然有題型可擴充性設計（見 `docs/domain/design/P0-5_QUESTION_MODALITY_EXTENSIBILITY.md`），但沒有明確的策略
- 不同階段應該使用什麼題型尚未確定

**影響**：
- **這是架構決策，不是細節優化**
- 必須在 P0-5 之前確定，否則可能影響後續開發

### 3. 八卦盤界面的明確規劃
**終極目標明確提到**：
- 「以東方命理、玄學、象數與隱喻作為人類可理解介面」
- 後續會使用「類似八卦盤或者是陰陽兩極之類的介面來作為題目選擇的互動過程」

**現狀問題**：
- 八卦盤界面的具體設計尚未確定
- 八卦盤界面如何與題型設計整合尚未明確
- 八卦盤界面在哪些階段使用尚未確定

**影響**：
- 如果現在不考慮，後續可能需要大幅修改
- **這是未來規劃，不是臨時需求**
- 必須在 P0-5 之前規劃，否則可能影響 UI 架構設計

---

## 專案歷史摘要（Project History Summary）

### 最近完成的任務（最近 3-5 個）

#### P0-4 Facet Portability & Stress Test（已完成）
- **狀態**：✅ READY_TO_FREEZE
- **完成日期**：2026-01-09
- **關鍵成果**：
  - 驗證 P0-3 結構可在 `relationship_imbalance` Facet 上零改動搬移
  - R2 交付：主隱喻「月相潮汐・盈虛觀」+ 次隱喻白名單
  - R4 交付：禁用詞擴充 + L4 高風險出口模板
- **詳細記錄**：見 `P0-4/P0-4_FREEZE_READINESS.md`

#### P0-3 Narrative Sharpness / Esoteric Precision（已完成）
- **狀態**：✅ READY_TO_FREEZE
- **完成日期**：2026-01-09
- **關鍵成果**：
  - 為 `income_expansion_pressure` 建立完整的敘事骨架與安全邊界
  - R1 交付：敘事銳利度指標 M1–M4 + Critical Fail 規則
  - R2 交付：L1–L4 敘事骨架 + 次隱喻白名單
  - R4 交付：禁用詞表 + L4 高風險出口模板
- **詳細記錄**：見 `P0-3/P0-3_FREEZE_READINESS.md`

#### P0-2 Output Contract（已完成）
- **狀態**：✅ COMPLETED
- **完成日期**：2026-01-07
- **關鍵成果**：定義系統級輸出合約（允許/禁止輸出、抽象層級、翻譯邊界、安全 fallback）

### 關鍵決策點
- **P0-3 決策**：採用「歲時農耕・倉廩觀」作為 `income_expansion_pressure` 的主隱喻
- **P0-4 決策**：採用「月相潮汐・盈虛觀」作為 `relationship_imbalance` 的主隱喻
- **架構決策**：採用「核心引擎穩定、內容外置化、schema 版本化」架構
- **ADR_0006 決策**：P0-2 期間禁止引入創新 UI 交互（八卦盤、符號多選），但保留未來設計空間

### 項目整體狀態
- **當前階段**：P0-4.5（題目流程與分流系統設計）← **新插入的臨時主線任務**
- **整體完成度**：約 60%（P0-1 到 P0-4 已完成，P0-4.5 和 P0-5 進行中）
- **階段性目標**：完成 MVP（最小可行產品）的端到端流程
- **整體決策脈絡**：先建立核心引擎和內容規範，再設計分流系統，再建立 UI 串接，最後建立付費/權限策略

---

## 終極目標（完整版）

**參考文件**：`FULL/NORTH_STAR.md`

### 核心要求
「打造一個以心理學、行為科學、認知結構、社會學、人類學等現代學術研究為底層引擎，
結合 GPT 與 Gemini 等 AI 工具進行資訊收集與大數據庫建構，
以東方命理、玄學、象數與隱喻作為人類可理解介面，
能夠適用於全世界、全文化、全人類、全年齡、全性別、全困擾、全問題場景的
解析、引導與連鎖互動系統。」

### 關鍵要求
1. **涵蓋全人類、全年齡、全困擾、全困境**：讓全世界所有國家、不分年齡、不分性別、不分困擾的人都可以映射和具現他們現在所面臨的困擾
2. **東方玄學界面**：以東方命理、玄學、象數與隱喻作為人類可理解介面
3. **八卦盤界面規劃**：後續會使用「類似八卦盤或者是陰陽兩極之類的介面來作為題目選擇的互動過程」

### 成功定義
使用者必須覺得：
- 這是一個玄學網站
- 這是一套命理／神秘系統
- 這個系統非常準
- 這個系統對自己很有幫助
- **不會覺得「沒有符合我困境的選項」**

---

## 背景資料（Background Information）

### 1. 現有 Facet 設計
- **`income_expansion_pressure`**（歲時農耕・倉廩觀）
  - 主隱喻：歲時農耕・倉廩觀
  - 次隱喻白名單：導引類、幻象類、修繕類、地形類
  - 題目數量：5 題（P0-2 設計）
- **`relationship_imbalance`**（月相潮汐・盈虛觀）
  - 主隱喻：月相潮汐・盈虛觀
  - 次隱喻白名單：潮汐類、光影類、周而復始類
  - 題目數量：待定（參考 P0-2 設計）

### 2. 現有 UI 架構設計
- **參考文件**：`P0-5/P0-5_UI_ARCHITECTURE.md`
- **Layer 2：困擾領域選擇層（Facet Gate）**
  - 卡片式困境選擇
  - 事業（`income_expansion_pressure`）
  - 關係（`relationship_imbalance`）
  - **問題**：只有兩個選項，無法「涵蓋全人類」
- **Layer 3：問題行走層（Question Walk）**
  - 當前實作：使用基礎的單選/多選形式
  - 未來擴充：支持八卦盤、符號多選等創新 UI
  - **問題**：題型選擇策略尚未明確

### 3. 題型可擴充性設計
- **參考文件**：`docs/domain/design/P0-5_QUESTION_MODALITY_EXTENSIBILITY.md`
- **核心原則**：數據層與呈現層分離
- **當前實作**：P0-5 可能使用基礎的單選/多選形式
- **未來擴充**：必須能夠無縫切換到八卦盤、符號多選等創新 UI
- **架構要求**：UI 架構必須支持題型呈現方式的替換

### 4. ADR_0006 決策
- **參考文件**：`docs/adr/ADR_0006_question_modality_scope_lock.md`
- **P0-2 期間**：禁止引入創新 UI 交互（八卦盤、符號多選）
- **保留未來設計空間**：明確批准並保留「符號化多代幣選擇介面（Symbolic multi-token selection）」作為未來發展方向
- **未來題型選項**：
  - 八卦盤（符號/詞彙多選）：讓使用者用多個獨立詞彙拼出狀態分佈
  - 方案 A：先八卦盤多選（掃描）→ 再單選（收斂/確認）
  - 方案 B：先單選（定位類別）→ 再八卦盤（細化強弱/細節）

---

## 任務內容（Task Content）

### 核心任務：設計多階段分流系統

#### 階段 1：全人類困境分類（Universal Problem Classification）
**目標**：如何涵蓋「全人類、全年齡、全困擾、全困境」

**關鍵問題**：
1. 如何分類「全人類、全年齡、全困擾、全困境」？
   - 應該使用什麼分類方式？（心理學分類、人生階段分類、生活領域分類等）
   - 如何確保分類涵蓋所有可能的困境？
   - 如何確保分類符合玄學語感？

2. 如何確保使用者不會覺得「沒有符合的選項」？
   - 如何設計選項，確保覆蓋面足夠廣？
   - 如何處理邊緣情況？
   - 是否需要設計「其他」選項？如果需要，如何設計？

3. 應該使用什麼題型？
   - 單選？複選？多選？符號選擇？
   - 是否使用八卦盤界面？
   - 如何確保題型符合玄學語感？

**預期產出**：
- 困境分類架構設計
- 題型選擇建議
- 「涵蓋全人類」的策略

#### 階段 2：困境細化選擇（Problem Refinement）
**目標**：如何在階段 1 的基礎上進一步細化

**關鍵問題**：
1. 如何細化困境？
   - 細化的程度應該到哪裡？
   - 如何確保細化過程符合玄學語感？
   - 如何確保細化後仍然能夠映射到 Facet？

2. 應該使用什麼題型？
   - 單選？複選？多選？符號選擇？
   - 是否使用八卦盤界面？

**預期產出**：
- 困境細化策略
- 題型選擇建議

#### 階段 3：Facet 選擇（Facet Selection）
**目標**：如何選擇對應的 Facet

**關鍵問題**：
1. 如何將困境映射到 Facet？
   - 一個困境可能對應多個 Facet，如何處理？
   - 如何確保映射邏輯符合玄學語感？

2. 應該使用什麼題型？
   - 單選？複選？多選？
   - 是否使用八卦盤界面？

**預期產出**：
- Facet 映射邏輯設計
- 題型選擇建議

#### 階段 4：題目問答（Question Answering）
**目標**：如何在選定的 Facet 上進行問答

**關鍵問題**：
1. 如何在選定的 Facet 上進行題目問答？
   - 題目數量應該是多少？
   - 題目順序應該如何安排？
   - 如何確保問答過程符合玄學語感？

2. 應該使用什麼題型？
   - 單選？複選？多選？符號選擇？
   - 是否使用八卦盤界面、陰陽兩極界面？

**預期產出**：
- 題目問答策略
- 題型選擇建議

#### 階段 5：結果呈現（Result Presentation）
**目標**：如何呈現結果

**關鍵問題**：
1. 如何在結果呈現時保持玄學語感？
2. 如何處理跨 Facet 的結果呈現？（如果使用者選擇了多個 Facet）

**預期產出**：
- 結果呈現策略

---

## 八卦盤界面整合規劃

### 八卦盤界面的定位
- **終極目標明確提到**：後續會使用「類似八卦盤或者是陰陽兩極之類的介面來作為題目選擇的互動過程」
- **ADR_0006**：明確批准並保留「符號化多代幣選擇介面（Symbolic multi-token selection）」作為未來發展方向

### 關鍵問題
1. **八卦盤界面在哪些階段使用？**
   - 階段 1（困境分類）是否使用八卦盤？
   - 階段 2（困境細化）是否使用八卦盤？
   - 階段 3（Facet 選擇）是否使用八卦盤？
   - 階段 4（題目問答）是否使用八卦盤、陰陽兩極等？

2. **八卦盤界面如何與題型設計整合？**
   - 八卦盤界面的數據結構要求
   - 八卦盤界面如何映射到題型選擇
   - 八卦盤界面如何收集答案
   - 八卦盤界面如何與現有的 compiled facet 結構整合

3. **八卦盤界面的設計原則**
   - 如何保持玄學語感
   - 如何確保使用者體驗
   - 如何支持未來的擴充

---

## 題型設計策略

### 不同階段應該使用什麼題型？

#### 階段 1：困境分類
**問題**：應該使用單選、複選、多選、符號選擇、八卦盤等哪種題型？

**考慮因素**：
- 需要涵蓋「全人類、全年齡、全困擾、全困境」
- 需要符合玄學語感
- 需要支持未來的八卦盤界面

#### 階段 2：困境細化
**問題**：應該使用什麼題型？

#### 階段 3：Facet 選擇
**問題**：應該使用什麼題型？

#### 階段 4：題目問答
**問題**：應該使用什麼題型？是否使用八卦盤、陰陽兩極等？

---

## 約束條件（Constraints）

### 硬性限制
- **不得違背終極目標**（`FULL/NORTH_STAR.md`）
- **必須符合「純玄學體驗」要求**（ADR_0002）
- **必須支持未來的八卦盤界面設計**
- **必須確保使用者不會覺得「沒有符合的選項」**
- **不得暴露內部結構**（不得使用心理學名詞、現代科學背景等）

### 設計原則
- **數據層與呈現層分離**：分流系統的數據結構獨立於 UI 呈現方式
- **可擴充性保證**：設計必須支持未來的擴充（如八卦盤界面）
- **玄學語感優先**：所有設計必須符合玄學語感，不暴露內部結構

### 失敗模式警告
- **失敗模式 A：不使用文本記錄**（見 `docs/governance/LEGACY_REFERENCE_STRATEGY.md`）
  - **歷史案例**：第一次失敗 - GPT 一直寫一直寫，最後一個人就寫出四個版本的題目，導致版本漂移
  - **必須執行**：所有決策和產出都必須立即寫入文本

- **失敗模式 B：把決定權責都交給 AI**（見 `docs/governance/LEGACY_REFERENCE_STRATEGY.md`）
  - **歷史案例**：第二次失敗 - AI 一開始把最高規範定死了，而且訂出沒辦法滿足終極目標的規範，導致後期沒有辦法修復
  - **必須執行**：使用者擁有最高主權，AI 不得自行訂死不可變的規則

---

## 交付物（Deliverables）

### 1. 多階段分流系統設計
- **文件**：`P0-4.5/P0-4.5_FUNNEL_SYSTEM_DESIGN.md`
- **內容**：
  - 階段 1：全人類困境分類（如何涵蓋所有可能的困境）
  - 階段 2：困境細化選擇（如何收斂到特定困境）
  - 階段 3：Facet 選擇（如何選擇對應的 Facet）
  - 階段 4：題目問答（如何在選定的 Facet 上進行問答）
  - 階段 5：結果呈現（如何呈現結果）

### 2. 題型設計策略
- **文件**：`P0-4.5/P0-4.5_QUESTION_MODALITY_STRATEGY.md`
- **內容**：
  - 不同階段應該使用什麼題型（單選、複選、多選、符號選擇等）
  - 如何為未來的八卦盤界面設計題型
  - 如何確保題型選擇不會讓使用者覺得「沒有符合的選項」

### 3. 八卦盤界面整合規劃
- **文件**：`P0-4.5/P0-4.5_BAGUA_INTERFACE_INTEGRATION_PLAN.md`
- **內容**：
  - 八卦盤界面在哪些階段使用
  - 八卦盤界面如何與題型設計整合
  - 八卦盤界面的設計原則

### 4. 題目設計方法論更新
- **文件**：`P0-4.5/P0-4.5_QUESTION_DESIGN_METHODOLOGY.md`
- **內容**：
  - 更新題目設計方法論，支持多階段分流系統
  - 如何設計「涵蓋全人類」的題目
  - 如何確保題目不會讓使用者覺得「沒有符合的選項」

---

## 成功標準（Success Criteria）

### 必須達成
- ✅ 設計出能夠「涵蓋全人類、全年齡、全困擾、全困境」的分流系統
- ✅ 確定不同階段應該使用的題型
- ✅ 設計出能夠支持未來八卦盤界面的題型結構
- ✅ 確保題目設計方法論能夠支持分流系統
- ✅ 副指揮官和顧問師都理解設計意圖和終極目標

### 品質要求
- ✅ 分流系統必須符合「純玄學體驗」要求
- ✅ 分流系統必須支持未來的八卦盤界面
- ✅ 分流系統必須確保使用者不會覺得「沒有符合的選項」

---

## 相關文件路徑（完整 Canon 路徑）

### 終極目標
- `FULL/NORTH_STAR.md`（終極目標完整版）
- `xuance-commander-core/MIN/NORTH_STAR.md`（終極目標簡要版）

### 現有設計文件
- `xuance-commander-core/P0-5/P0-5_UI_ARCHITECTURE.md`（P0-5 UI 架構設計）
- `xuance-commander-core/P0-5/P0-5_UI_INTEGRATION_SPEC.md`（P0-5 UI 串接規格）
- `xuance-commander-core/docs/domain/design/P0-5_QUESTION_MODALITY_EXTENSIBILITY.md`（題型可擴充性設計）
- `xuance-commander-core/docs/domain/design/P0-5_UI_DESIGN_REQUIREMENTS.md`（UI 設計需求）

### 架構決策
- `xuance-commander-core/docs/adr/ADR_0006_question_modality_scope_lock.md`（P0-2 題型範圍鎖定）

### 現有 Facet 設計
- `xuance-commander-core/P0-4/P0-4_CHARTER.md`（P0-4 憲章）
- `xuance-commander-core/P0-4/P0-4_FACET_BRIEF.md`（P0-4 Facet 簡報）
- `xuance-commander-core/docs/domain/advisory/R2/P0-3_SECONDARY_METAPHOR_WHITELIST.md`（P0-3 次隱喻白名單）
- `xuance-commander-core/docs/domain/advisory/R2/P0-4_SECONDARY_METAPHOR_WHITELIST.md`（P0-4 次隱喻白名單）

### 治理規則
- `xuance-commander-core/docs/governance/AI_ADVISORY_ROLES.md`（AI 顧問角色定義）
- `xuance-commander-core/docs/governance/LEGACY_REFERENCE_STRATEGY.md`（Legacy 參考策略，包含失敗模式警告）

---

## 狀態
- ACTIVE
- EDITABLE
- 優先級：P0（立即處理，阻斷主線）
- 建立日期：2026-01-10



